(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2513],{3540:function(e,t,r){"use strict";var s=r(4836);t.Z=void 0;var n=s(r(4938)),i=r(5893);t.Z=(0,n.default)((0,i.jsx)("path",{d:"m17 7-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4z"}),"Logout")},1752:function(e,t,r){e.exports=r(5612)},3271:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Image",{enumerable:!0,get:function(){return m}});let s=r(8754),n=r(1757),i=n._(r(7294)),a=s._(r(3935)),o=s._(r(9201)),l=r(3914),c=r(5494),u=r(869);r(1905);let d=r(1823),h=s._(r(4545)),f={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image/",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0};function handleLoading(e,t,r,s,n,i){let a=null==e?void 0:e.src;if(!e||e["data-loaded-src"]===a)return;e["data-loaded-src"]=a;let o="decode"in e?e.decode():Promise.resolve();o.catch(()=>{}).then(()=>{if(e.parentElement&&e.isConnected){if("empty"!==t&&n(!0),null==r?void 0:r.current){let t=new Event("load");Object.defineProperty(t,"target",{writable:!1,value:e});let s=!1,n=!1;r.current({...t,nativeEvent:t,currentTarget:e,target:e,isDefaultPrevented:()=>s,isPropagationStopped:()=>n,persist:()=>{},preventDefault:()=>{s=!0,t.preventDefault()},stopPropagation:()=>{n=!0,t.stopPropagation()}})}(null==s?void 0:s.current)&&s.current(e)}})}function getDynamicProps(e){let[t,r]=i.version.split("."),s=parseInt(t,10),n=parseInt(r,10);return s>18||18===s&&n>=3?{fetchPriority:e}:{fetchpriority:e}}let p=(0,i.forwardRef)((e,t)=>{let{src:r,srcSet:s,sizes:n,height:a,width:o,decoding:l,className:c,style:u,fetchPriority:d,placeholder:h,loading:f,unoptimized:p,fill:m,onLoadRef:g,onLoadingCompleteRef:A,setBlurComplete:b,setShowAltText:y,onLoad:E,onError:_,...v}=e;return i.default.createElement("img",{...v,...getDynamicProps(d),loading:f,width:o,height:a,decoding:l,"data-nimg":m?"fill":"1",className:c,style:u,sizes:n,srcSet:s,src:r,ref:(0,i.useCallback)(e=>{t&&("function"==typeof t?t(e):"object"==typeof t&&(t.current=e)),e&&(_&&(e.src=e.src),e.complete&&handleLoading(e,h,g,A,b,p))},[r,h,g,A,b,_,p,t]),onLoad:e=>{let t=e.currentTarget;handleLoading(t,h,g,A,b,p)},onError:e=>{y(!0),"empty"!==h&&b(!0),_&&_(e)}})});function ImagePreload(e){let{isAppRouter:t,imgAttributes:r}=e,s={as:"image",imageSrcSet:r.srcSet,imageSizes:r.sizes,crossOrigin:r.crossOrigin,referrerPolicy:r.referrerPolicy,...getDynamicProps(r.fetchPriority)};return t&&a.default.preload?(a.default.preload(r.src,s),null):i.default.createElement(o.default,null,i.default.createElement("link",{key:"__nimg-"+r.src+r.srcSet+r.sizes,rel:"preload",href:r.srcSet?void 0:r.src,...s}))}let m=(0,i.forwardRef)((e,t)=>{let r=(0,i.useContext)(d.RouterContext),s=(0,i.useContext)(u.ImageConfigContext),n=(0,i.useMemo)(()=>{let e=f||s||c.imageConfigDefault,t=[...e.deviceSizes,...e.imageSizes].sort((e,t)=>e-t),r=e.deviceSizes.sort((e,t)=>e-t);return{...e,allSizes:t,deviceSizes:r}},[s]),{onLoad:a,onLoadingComplete:o}=e,m=(0,i.useRef)(a);(0,i.useEffect)(()=>{m.current=a},[a]);let g=(0,i.useRef)(o);(0,i.useEffect)(()=>{g.current=o},[o]);let[A,b]=(0,i.useState)(!1),[y,E]=(0,i.useState)(!1),{props:_,meta:v}=(0,l.getImgProps)(e,{defaultLoader:h.default,imgConf:n,blurComplete:A,showAltText:y});return i.default.createElement(i.default.Fragment,null,i.default.createElement(p,{..._,unoptimized:v.unoptimized,placeholder:v.placeholder,fill:v.fill,onLoadRef:m,onLoadingCompleteRef:g,setBlurComplete:b,setShowAltText:E,ref:t}),v.priority?i.default.createElement(ImagePreload,{isAppRouter:!r,imgAttributes:_}):null)});("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},3914:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getImgProps",{enumerable:!0,get:function(){return getImgProps}}),r(1905);let s=r(2393),n=r(5494);function isStaticRequire(e){return void 0!==e.default}function getInt(e){return void 0===e?e:"number"==typeof e?Number.isFinite(e)?e:NaN:"string"==typeof e&&/^[0-9]+$/.test(e)?parseInt(e,10):NaN}function getImgProps(e,t){var r;let i,a,o,{src:l,sizes:c,unoptimized:u=!1,priority:d=!1,loading:h,className:f,quality:p,width:m,height:g,fill:A=!1,style:b,onLoad:y,onLoadingComplete:E,placeholder:_="empty",blurDataURL:v,fetchPriority:w,layout:R,objectFit:S,objectPosition:T,lazyBoundary:P,lazyRoot:C,...x}=e,{imgConf:I,showAltText:O,blurComplete:F,defaultLoader:M}=t,L=I||n.imageConfigDefault;if("allSizes"in L)i=L;else{let e=[...L.deviceSizes,...L.imageSizes].sort((e,t)=>e-t),t=L.deviceSizes.sort((e,t)=>e-t);i={...L,allSizes:e,deviceSizes:t}}let N=x.loader||M;delete x.loader,delete x.srcSet;let k="__next_img_default"in N;if(k){if("custom"===i.loader)throw Error('Image with src "'+l+'" is missing "loader" prop.\nRead more: https://nextjs.org/docs/messages/next-image-missing-loader')}else{let e=N;N=t=>{let{config:r,...s}=t;return e(s)}}if(R){"fill"===R&&(A=!0);let e={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[R];e&&(b={...b,...e});let t={responsive:"100vw",fill:"100vw"}[R];t&&!c&&(c=t)}let G="",D=getInt(m),j=getInt(g);if("object"==typeof(r=l)&&(isStaticRequire(r)||void 0!==r.src)){let e=isStaticRequire(l)?l.default:l;if(!e.src)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received "+JSON.stringify(e));if(!e.height||!e.width)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received "+JSON.stringify(e));if(a=e.blurWidth,o=e.blurHeight,v=v||e.blurDataURL,G=e.src,!A){if(D||j){if(D&&!j){let t=D/e.width;j=Math.round(e.height*t)}else if(!D&&j){let t=j/e.height;D=Math.round(e.width*t)}}else D=e.width,j=e.height}}let U=!d&&("lazy"===h||void 0===h);(!(l="string"==typeof l?l:G)||l.startsWith("data:")||l.startsWith("blob:"))&&(u=!0,U=!1),i.unoptimized&&(u=!0),k&&l.endsWith(".svg")&&!i.dangerouslyAllowSVG&&(u=!0),d&&(w="high");let B=getInt(p),H=Object.assign(A?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:S,objectPosition:T}:{},O?{}:{color:"transparent"},b),q=F||"empty"===_?null:"blur"===_?'url("data:image/svg+xml;charset=utf-8,'+(0,s.getImageBlurSvg)({widthInt:D,heightInt:j,blurWidth:a,blurHeight:o,blurDataURL:v||"",objectFit:H.objectFit})+'")':'url("'+_+'")',$=q?{backgroundSize:H.objectFit||"cover",backgroundPosition:H.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:q}:{},K=function(e){let{config:t,src:r,unoptimized:s,width:n,quality:i,sizes:a,loader:o}=e;if(s)return{src:r,srcSet:void 0,sizes:void 0};let{widths:l,kind:c}=function(e,t,r){let{deviceSizes:s,allSizes:n}=e;if(r){let e=/(^|\s)(1?\d?\d)vw/g,t=[];for(let s;s=e.exec(r);s)t.push(parseInt(s[2]));if(t.length){let e=.01*Math.min(...t);return{widths:n.filter(t=>t>=s[0]*e),kind:"w"}}return{widths:n,kind:"w"}}if("number"!=typeof t)return{widths:s,kind:"w"};let i=[...new Set([t,2*t].map(e=>n.find(t=>t>=e)||n[n.length-1]))];return{widths:i,kind:"x"}}(t,n,a),u=l.length-1;return{sizes:a||"w"!==c?a:"100vw",srcSet:l.map((e,s)=>o({config:t,src:r,quality:i,width:e})+" "+("w"===c?e:s+1)+c).join(", "),src:o({config:t,src:r,quality:i,width:l[u]})}}({config:i,src:l,unoptimized:u,width:D,quality:B,sizes:c,loader:N}),V={...x,loading:U?"lazy":h,fetchPriority:w,width:D,height:j,decoding:"async",className:f,style:{...H,...$},sizes:K.sizes,srcSet:K.srcSet,src:K.src},z={unoptimized:u,priority:d,placeholder:_,fill:A};return{props:V,meta:z}}},2393:function(e,t){"use strict";function getImageBlurSvg(e){let{widthInt:t,heightInt:r,blurWidth:s,blurHeight:n,blurDataURL:i,objectFit:a}=e,o=s?40*s:t,l=n?40*n:r,c=o&&l?"viewBox='0 0 "+o+" "+l+"'":"";return"%3Csvg xmlns='http://www.w3.org/2000/svg' "+c+"%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='"+(c?"none":"contain"===a?"xMidYMid":"cover"===a?"xMidYMid slice":"none")+"' style='filter: url(%23b);' href='"+i+"'/%3E%3C/svg%3E"}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getImageBlurSvg",{enumerable:!0,get:function(){return getImageBlurSvg}})},7178:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{unstable_getImgProps:function(){return unstable_getImgProps},default:function(){return l}});let s=r(8754),n=r(3914),i=r(1905),a=r(3271),o=s._(r(4545)),unstable_getImgProps=e=>{(0,i.warnOnce)("Warning: unstable_getImgProps() is experimental and may change or be removed at any time. Use at your own risk.");let{props:t}=(0,n.getImgProps)(e,{defaultLoader:o.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image/",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}},l=a.Image},4545:function(e,t){"use strict";function defaultLoader(e){let{config:t,src:r,width:s,quality:n}=e;return t.path+"?url="+encodeURIComponent(r)+"&w="+s+"&q="+(n||75)}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r}}),defaultLoader.__next_img_default=!0;let r=defaultLoader},9008:function(e,t,r){e.exports=r(9201)},5675:function(e,t,r){e.exports=r(7178)},1341:function(e,t,r){"use strict";var s,n,i,a,o,l,c,u,d,h,f,p,m,g,A,b,y,E;r.d(t,{$D:function(){return GoogleGenerativeAI}});/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _=["user","model","function","system"];(h=s||(s={})).HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",h.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",h.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",h.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",h.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",(f=n||(n={})).HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",f.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",f.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",f.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",f.BLOCK_NONE="BLOCK_NONE",(p=i||(i={})).HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",p.NEGLIGIBLE="NEGLIGIBLE",p.LOW="LOW",p.MEDIUM="MEDIUM",p.HIGH="HIGH",(m=a||(a={})).BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",m.SAFETY="SAFETY",m.OTHER="OTHER",(g=o||(o={})).FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",g.STOP="STOP",g.MAX_TOKENS="MAX_TOKENS",g.SAFETY="SAFETY",g.RECITATION="RECITATION",g.OTHER="OTHER",(A=l||(l={})).TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",A.RETRIEVAL_QUERY="RETRIEVAL_QUERY",A.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",A.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",A.CLASSIFICATION="CLASSIFICATION",A.CLUSTERING="CLUSTERING",(b=c||(c={})).MODE_UNSPECIFIED="MODE_UNSPECIFIED",b.AUTO="AUTO",b.ANY="ANY",b.NONE="NONE",(y=u||(u={})).STRING="STRING",y.NUMBER="NUMBER",y.INTEGER="INTEGER",y.BOOLEAN="BOOLEAN",y.ARRAY="ARRAY",y.OBJECT="OBJECT";/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let GoogleGenerativeAIError=class GoogleGenerativeAIError extends Error{constructor(e){super(`[GoogleGenerativeAI Error]: ${e}`)}};let GoogleGenerativeAIResponseError=class GoogleGenerativeAIResponseError extends GoogleGenerativeAIError{constructor(e,t){super(e),this.response=t}};let GoogleGenerativeAIFetchError=class GoogleGenerativeAIFetchError extends GoogleGenerativeAIError{constructor(e,t,r,s){super(e),this.status=t,this.statusText=r,this.errorDetails=s}};let GoogleGenerativeAIRequestInputError=class GoogleGenerativeAIRequestInputError extends GoogleGenerativeAIError{};(E=d||(d={})).GENERATE_CONTENT="generateContent",E.STREAM_GENERATE_CONTENT="streamGenerateContent",E.COUNT_TOKENS="countTokens",E.EMBED_CONTENT="embedContent",E.BATCH_EMBED_CONTENTS="batchEmbedContents";let RequestUrl=class RequestUrl{constructor(e,t,r,s,n){this.model=e,this.task=t,this.apiKey=r,this.stream=s,this.requestOptions=n}toString(){var e,t;let r=(null===(e=this.requestOptions)||void 0===e?void 0:e.apiVersion)||"v1beta",s=(null===(t=this.requestOptions)||void 0===t?void 0:t.baseUrl)||"https://generativelanguage.googleapis.com",n=`${s}/${r}/${this.model}:${this.task}`;return this.stream&&(n+="?alt=sse"),n}};async function getHeaders(e){let t=new Headers;t.append("Content-Type","application/json"),t.append("x-goog-api-client",function(e){let t=[];return(null==e?void 0:e.apiClient)&&t.push(e.apiClient),t.push("genai-js/0.12.0"),t.join(" ")}(e.requestOptions)),t.append("x-goog-api-key",e.apiKey);let r=e.requestOptions.customHeaders;if(r){if(!(r instanceof Headers))try{r=new Headers(r)}catch(e){throw new GoogleGenerativeAIRequestInputError(`unable to convert customHeaders value ${JSON.stringify(r)} to Headers: ${e.message}`)}for(let[e,s]of r.entries()){if("x-goog-api-key"===e)throw new GoogleGenerativeAIRequestInputError(`Cannot set reserved header name ${e}`);if("x-goog-api-client"===e)throw new GoogleGenerativeAIRequestInputError(`Header name ${e} can only be set using the apiClient field`);t.append(e,s)}}return t}async function constructRequest(e,t,r,s,n,i){let a=new RequestUrl(e,t,r,s,i);return{url:a.toString(),fetchOptions:Object.assign(Object.assign({},function(e){let t={};if((null==e?void 0:e.timeout)>=0){let r=new AbortController,s=r.signal;setTimeout(()=>r.abort(),e.timeout),t.signal=s}return t}(i)),{method:"POST",headers:await getHeaders(a),body:n})}}async function makeRequest(e,t,r,s,n,i){return _makeRequestInternal(e,t,r,s,n,i,fetch)}async function _makeRequestInternal(e,t,r,s,n,i,a=fetch){let o;let l=new RequestUrl(e,t,r,s,i);try{let c=await constructRequest(e,t,r,s,n,i);if(!(o=await a(c.url,c.fetchOptions)).ok){let e,t="";try{let r=await o.json();t=r.error.message,r.error.details&&(t+=` ${JSON.stringify(r.error.details)}`,e=r.error.details)}catch(e){}throw new GoogleGenerativeAIFetchError(`Error fetching from ${l.toString()}: [${o.status} ${o.statusText}] ${t}`,o.status,o.statusText,e)}}catch(t){let e=t;throw t instanceof GoogleGenerativeAIFetchError||t instanceof GoogleGenerativeAIRequestInputError||((e=new GoogleGenerativeAIError(`Error fetching from ${l.toString()}: ${t.message}`)).stack=t.stack),e}return o}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function addHelpers(e){return e.text=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),hadBadFinishReason(e.candidates[0]))throw new GoogleGenerativeAIResponseError(`${formatBlockErrorMessage(e)}`,e);return function(e){var t,r,s,n;let i=[];if(null===(r=null===(t=e.candidates)||void 0===t?void 0:t[0].content)||void 0===r?void 0:r.parts)for(let t of null===(n=null===(s=e.candidates)||void 0===s?void 0:s[0].content)||void 0===n?void 0:n.parts)t.text&&i.push(t.text);return i.length>0?i.join(""):""}(e)}if(e.promptFeedback)throw new GoogleGenerativeAIResponseError(`Text not available. ${formatBlockErrorMessage(e)}`,e);return""},e.functionCall=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),hadBadFinishReason(e.candidates[0]))throw new GoogleGenerativeAIResponseError(`${formatBlockErrorMessage(e)}`,e);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),getFunctionCalls(e)[0]}if(e.promptFeedback)throw new GoogleGenerativeAIResponseError(`Function call not available. ${formatBlockErrorMessage(e)}`,e)},e.functionCalls=()=>{if(e.candidates&&e.candidates.length>0){if(e.candidates.length>1&&console.warn(`This response had ${e.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),hadBadFinishReason(e.candidates[0]))throw new GoogleGenerativeAIResponseError(`${formatBlockErrorMessage(e)}`,e);return getFunctionCalls(e)}if(e.promptFeedback)throw new GoogleGenerativeAIResponseError(`Function call not available. ${formatBlockErrorMessage(e)}`,e)},e}function getFunctionCalls(e){var t,r,s,n;let i=[];if(null===(r=null===(t=e.candidates)||void 0===t?void 0:t[0].content)||void 0===r?void 0:r.parts)for(let t of null===(n=null===(s=e.candidates)||void 0===s?void 0:s[0].content)||void 0===n?void 0:n.parts)t.functionCall&&i.push(t.functionCall);return i.length>0?i:void 0}let v=[o.RECITATION,o.SAFETY];function hadBadFinishReason(e){return!!e.finishReason&&v.includes(e.finishReason)}function formatBlockErrorMessage(e){var t,r,s;let n="";if((!e.candidates||0===e.candidates.length)&&e.promptFeedback)n+="Response was blocked",(null===(t=e.promptFeedback)||void 0===t?void 0:t.blockReason)&&(n+=` due to ${e.promptFeedback.blockReason}`),(null===(r=e.promptFeedback)||void 0===r?void 0:r.blockReasonMessage)&&(n+=`: ${e.promptFeedback.blockReasonMessage}`);else if(null===(s=e.candidates)||void 0===s?void 0:s[0]){let t=e.candidates[0];hadBadFinishReason(t)&&(n+=`Candidate was blocked due to ${t.finishReason}`,t.finishMessage&&(n+=`: ${t.finishMessage}`))}return n}function __await(e){return this instanceof __await?(this.v=e,this):new __await(e)}"function"==typeof SuppressedError&&SuppressedError;/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let w=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;async function getResponsePromise(e){let t=[],r=e.getReader();for(;;){let{done:e,value:s}=await r.read();if(e)return addHelpers(function(e){let t=e[e.length-1],r={promptFeedback:null==t?void 0:t.promptFeedback};for(let t of e)if(t.candidates)for(let e of t.candidates){let t=e.index;if(r.candidates||(r.candidates=[]),r.candidates[t]||(r.candidates[t]={index:e.index}),r.candidates[t].citationMetadata=e.citationMetadata,r.candidates[t].finishReason=e.finishReason,r.candidates[t].finishMessage=e.finishMessage,r.candidates[t].safetyRatings=e.safetyRatings,e.content&&e.content.parts){r.candidates[t].content||(r.candidates[t].content={role:e.content.role||"user",parts:[]});let s={};for(let n of e.content.parts)n.text&&(s.text=n.text),n.functionCall&&(s.functionCall=n.functionCall),0===Object.keys(s).length&&(s.text=""),r.candidates[t].content.parts.push(s)}}return r}(t));t.push(s)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function generateContentStream(e,t,r,s){let n=await makeRequest(t,d.STREAM_GENERATE_CONTENT,e,!0,JSON.stringify(r),s);return function(e){let t=e.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),r=function(e){let t=e.getReader(),r=new ReadableStream({start(e){let r="";return function pump(){return t.read().then(({value:t,done:s})=>{let n;if(s){if(r.trim()){e.error(new GoogleGenerativeAIError("Failed to parse stream"));return}e.close();return}let i=(r+=t).match(w);for(;i;){try{n=JSON.parse(i[1])}catch(t){e.error(new GoogleGenerativeAIError(`Error parsing JSON response: "${i[1]}"`));return}e.enqueue(n),i=(r=r.substring(i[0].length)).match(w)}return pump()})}()}});return r}(t),[s,n]=r.tee();return{stream:function(e){return function(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var s,n=r.apply(e,t||[]),i=[];return s={},verb("next"),verb("throw"),verb("return"),s[Symbol.asyncIterator]=function(){return this},s;function verb(e){n[e]&&(s[e]=function(t){return new Promise(function(r,s){i.push([e,t,r,s])>1||resume(e,t)})})}function resume(e,t){try{var r;(r=n[e](t)).value instanceof __await?Promise.resolve(r.value.v).then(fulfill,reject):settle(i[0][2],r)}catch(e){settle(i[0][3],e)}}function fulfill(e){resume("next",e)}function reject(e){resume("throw",e)}function settle(e,t){e(t),i.shift(),i.length&&resume(i[0][0],i[0][1])}}(this,arguments,function*(){let t=e.getReader();for(;;){let{value:e,done:r}=yield __await(t.read());if(r)break;yield yield __await(addHelpers(e))}})}(s),response:getResponsePromise(n)}}(n)}async function generateContent(e,t,r,s){let n=await makeRequest(t,d.GENERATE_CONTENT,e,!1,JSON.stringify(r),s),i=await n.json(),a=addHelpers(i);return{response:a}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function formatSystemInstruction(e){if(null!=e){if("string"==typeof e)return{role:"system",parts:[{text:e}]};if(e.text)return{role:"system",parts:[e]};if(e.parts)return e.role?e:{role:"system",parts:e.parts}}}function formatNewContent(e){let t=[];if("string"==typeof e)t=[{text:e}];else for(let r of e)"string"==typeof r?t.push({text:r}):t.push(r);return function(e){let t={role:"user",parts:[]},r={role:"function",parts:[]},s=!1,n=!1;for(let i of e)"functionResponse"in i?(r.parts.push(i),n=!0):(t.parts.push(i),s=!0);if(s&&n)throw new GoogleGenerativeAIError("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!s&&!n)throw new GoogleGenerativeAIError("No content is provided for sending chat message.");return s?t:r}(t)}function formatGenerateContentInput(e){let t;if(e.contents)t=e;else{let r=formatNewContent(e);t={contents:[r]}}return e.systemInstruction&&(t.systemInstruction=formatSystemInstruction(e.systemInstruction)),t}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let R=["text","inlineData","functionCall","functionResponse"],S={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall"],system:["text"]},T="SILENT_ERROR";let ChatSession=class ChatSession{constructor(e,t,r,s){this.model=t,this.params=r,this.requestOptions=s,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=e,(null==r?void 0:r.history)&&(function(e){let t=!1;for(let r of e){let{role:e,parts:s}=r;if(!t&&"user"!==e)throw new GoogleGenerativeAIError(`First content should be with role 'user', got ${e}`);if(!_.includes(e))throw new GoogleGenerativeAIError(`Each item should include role field. Got ${e} but valid roles are: ${JSON.stringify(_)}`);if(!Array.isArray(s))throw new GoogleGenerativeAIError("Content should have 'parts' property with an array of Parts");if(0===s.length)throw new GoogleGenerativeAIError("Each Content should have at least one part");let n={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0};for(let e of s)for(let t of R)t in e&&(n[t]+=1);let i=S[e];for(let t of R)if(!i.includes(t)&&n[t]>0)throw new GoogleGenerativeAIError(`Content with role '${e}' can't contain '${t}' part`);t=!0}}(r.history),this._history=r.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(e){var t,r,s,n,i;let a;await this._sendPromise;let o=formatNewContent(e),l={safetySettings:null===(t=this.params)||void 0===t?void 0:t.safetySettings,generationConfig:null===(r=this.params)||void 0===r?void 0:r.generationConfig,tools:null===(s=this.params)||void 0===s?void 0:s.tools,toolConfig:null===(n=this.params)||void 0===n?void 0:n.toolConfig,systemInstruction:null===(i=this.params)||void 0===i?void 0:i.systemInstruction,contents:[...this._history,o]};return this._sendPromise=this._sendPromise.then(()=>generateContent(this._apiKey,this.model,l,this.requestOptions)).then(e=>{var t;if(e.response.candidates&&e.response.candidates.length>0){this._history.push(o);let r=Object.assign({parts:[],role:"model"},null===(t=e.response.candidates)||void 0===t?void 0:t[0].content);this._history.push(r)}else{let t=formatBlockErrorMessage(e.response);t&&console.warn(`sendMessage() was unsuccessful. ${t}. Inspect response object for details.`)}a=e}),await this._sendPromise,a}async sendMessageStream(e){var t,r,s,n,i;await this._sendPromise;let a=formatNewContent(e),o={safetySettings:null===(t=this.params)||void 0===t?void 0:t.safetySettings,generationConfig:null===(r=this.params)||void 0===r?void 0:r.generationConfig,tools:null===(s=this.params)||void 0===s?void 0:s.tools,toolConfig:null===(n=this.params)||void 0===n?void 0:n.toolConfig,systemInstruction:null===(i=this.params)||void 0===i?void 0:i.systemInstruction,contents:[...this._history,a]},l=generateContentStream(this._apiKey,this.model,o,this.requestOptions);return this._sendPromise=this._sendPromise.then(()=>l).catch(e=>{throw Error(T)}).then(e=>e.response).then(e=>{if(e.candidates&&e.candidates.length>0){this._history.push(a);let t=Object.assign({},e.candidates[0].content);t.role||(t.role="model"),this._history.push(t)}else{let t=formatBlockErrorMessage(e);t&&console.warn(`sendMessageStream() was unsuccessful. ${t}. Inspect response object for details.`)}}).catch(e=>{e.message!==T&&console.error(e)}),l}};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function countTokens(e,t,r,s){let n=await makeRequest(t,d.COUNT_TOKENS,e,!1,JSON.stringify(Object.assign(Object.assign({},r),{model:t})),s);return n.json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function embedContent(e,t,r,s){let n=await makeRequest(t,d.EMBED_CONTENT,e,!1,JSON.stringify(r),s);return n.json()}async function batchEmbedContents(e,t,r,s){let n=r.requests.map(e=>Object.assign(Object.assign({},e),{model:t})),i=await makeRequest(t,d.BATCH_EMBED_CONTENTS,e,!1,JSON.stringify({requests:n}),s);return i.json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let GenerativeModel=class GenerativeModel{constructor(e,t,r){this.apiKey=e,t.model.includes("/")?this.model=t.model:this.model=`models/${t.model}`,this.generationConfig=t.generationConfig||{},this.safetySettings=t.safetySettings||[],this.tools=t.tools,this.toolConfig=t.toolConfig,this.systemInstruction=formatSystemInstruction(t.systemInstruction),this.requestOptions=r||{}}async generateContent(e){let t=formatGenerateContentInput(e);return generateContent(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction},t),this.requestOptions)}async generateContentStream(e){let t=formatGenerateContentInput(e);return generateContentStream(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction},t),this.requestOptions)}startChat(e){return new ChatSession(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction},e),this.requestOptions)}async countTokens(e){let t=formatGenerateContentInput(e);return countTokens(this.apiKey,this.model,t,this.requestOptions)}async embedContent(e){let t=function(e){if("string"==typeof e||Array.isArray(e)){let t=formatNewContent(e);return{content:t}}return e}(e);return embedContent(this.apiKey,this.model,t,this.requestOptions)}async batchEmbedContents(e){return batchEmbedContents(this.apiKey,this.model,e,this.requestOptions)}};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let GoogleGenerativeAI=class GoogleGenerativeAI{constructor(e){this.apiKey=e}getGenerativeModel(e,t){if(!e.model)throw new GoogleGenerativeAIError("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new GenerativeModel(this.apiKey,e,t)}}},7066:function(e,t,r){"use strict";r.d(t,{Z:function(){return e_}});var s,n,i,a,o,l={};function bind(e,t){return function(){return e.apply(t,arguments)}}r.r(l),r.d(l,{hasBrowserEnv:function(){return z},hasStandardBrowserEnv:function(){return W},hasStandardBrowserWebWorkerEnv:function(){return X},origin:function(){return J}});let{toString:c}=Object.prototype,{getPrototypeOf:u}=Object,d=(s=Object.create(null),e=>{let t=c.call(e);return s[t]||(s[t]=t.slice(8,-1).toLowerCase())}),kindOfTest=e=>(e=e.toLowerCase(),t=>d(t)===e),typeOfTest=e=>t=>typeof t===e,{isArray:h}=Array,f=typeOfTest("undefined"),p=kindOfTest("ArrayBuffer"),m=typeOfTest("string"),g=typeOfTest("function"),A=typeOfTest("number"),isObject=e=>null!==e&&"object"==typeof e,isPlainObject=e=>{if("object"!==d(e))return!1;let t=u(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},b=kindOfTest("Date"),y=kindOfTest("File"),E=kindOfTest("Blob"),_=kindOfTest("FileList"),v=kindOfTest("URLSearchParams"),[w,R,S,T]=["ReadableStream","Request","Response","Headers"].map(kindOfTest);function forEach(e,t,{allOwnKeys:r=!1}={}){let s,n;if(null!=e){if("object"!=typeof e&&(e=[e]),h(e))for(s=0,n=e.length;s<n;s++)t.call(null,e[s],s,e);else{let n;let i=r?Object.getOwnPropertyNames(e):Object.keys(e),a=i.length;for(s=0;s<a;s++)n=i[s],t.call(null,e[n],n,e)}}}function findKey(e,t){let r;t=t.toLowerCase();let s=Object.keys(e),n=s.length;for(;n-- >0;)if(t===(r=s[n]).toLowerCase())return r;return null}let P="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,isContextDefined=e=>!f(e)&&e!==P,C=(n="undefined"!=typeof Uint8Array&&u(Uint8Array),e=>n&&e instanceof n),x=kindOfTest("HTMLFormElement"),I=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),O=kindOfTest("RegExp"),reduceDescriptors=(e,t)=>{let r=Object.getOwnPropertyDescriptors(e),s={};forEach(r,(r,n)=>{let i;!1!==(i=t(r,n,e))&&(s[n]=i||r)}),Object.defineProperties(e,s)},F="abcdefghijklmnopqrstuvwxyz",M="0123456789",L={DIGIT:M,ALPHA:F,ALPHA_DIGIT:F+F.toUpperCase()+M},N=kindOfTest("AsyncFunction");var k={isArray:h,isArrayBuffer:p,isBuffer:function(e){return null!==e&&!f(e)&&null!==e.constructor&&!f(e.constructor)&&g(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"==typeof FormData&&e instanceof FormData||g(e.append)&&("formdata"===(t=d(e))||"object"===t&&g(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&p(e.buffer)},isString:m,isNumber:A,isBoolean:e=>!0===e||!1===e,isObject,isPlainObject,isReadableStream:w,isRequest:R,isResponse:S,isHeaders:T,isUndefined:f,isDate:b,isFile:y,isBlob:E,isRegExp:O,isFunction:g,isStream:e=>isObject(e)&&g(e.pipe),isURLSearchParams:v,isTypedArray:C,isFileList:_,forEach,merge:function merge(){let{caseless:e}=isContextDefined(this)&&this||{},t={},assignValue=(r,s)=>{let n=e&&findKey(t,s)||s;isPlainObject(t[n])&&isPlainObject(r)?t[n]=merge(t[n],r):isPlainObject(r)?t[n]=merge({},r):h(r)?t[n]=r.slice():t[n]=r};for(let e=0,t=arguments.length;e<t;e++)arguments[e]&&forEach(arguments[e],assignValue);return t},extend:(e,t,r,{allOwnKeys:s}={})=>(forEach(t,(t,s)=>{r&&g(t)?e[s]=bind(t,r):e[s]=t},{allOwnKeys:s}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,r,s)=>{e.prototype=Object.create(t.prototype,s),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},toFlatObject:(e,t,r,s)=>{let n,i,a;let o={};if(t=t||{},null==e)return t;do{for(i=(n=Object.getOwnPropertyNames(e)).length;i-- >0;)a=n[i],(!s||s(a,e,t))&&!o[a]&&(t[a]=e[a],o[a]=!0);e=!1!==r&&u(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},kindOf:d,kindOfTest,endsWith:(e,t,r)=>{e=String(e),(void 0===r||r>e.length)&&(r=e.length),r-=t.length;let s=e.indexOf(t,r);return -1!==s&&s===r},toArray:e=>{if(!e)return null;if(h(e))return e;let t=e.length;if(!A(t))return null;let r=Array(t);for(;t-- >0;)r[t]=e[t];return r},forEachEntry:(e,t)=>{let r;let s=e&&e[Symbol.iterator],n=s.call(e);for(;(r=n.next())&&!r.done;){let s=r.value;t.call(e,s[0],s[1])}},matchAll:(e,t)=>{let r;let s=[];for(;null!==(r=e.exec(t));)s.push(r);return s},isHTMLForm:x,hasOwnProperty:I,hasOwnProp:I,reduceDescriptors,freezeMethods:e=>{reduceDescriptors(e,(t,r)=>{if(g(e)&&-1!==["arguments","caller","callee"].indexOf(r))return!1;let s=e[r];if(g(s)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},toObjectSet:(e,t)=>{let r={};return(e=>{e.forEach(e=>{r[e]=!0})})(h(e)?e:String(e).split(t)),r},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,r){return t.toUpperCase()+r}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey,global:P,isContextDefined,ALPHABET:L,generateString:(e=16,t=L.ALPHA_DIGIT)=>{let r="",{length:s}=t;for(;e--;)r+=t[Math.random()*s|0];return r},isSpecCompliantForm:function(e){return!!(e&&g(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{let t=Array(10),visit=(e,r)=>{if(isObject(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;let s=h(e)?[]:{};return forEach(e,(e,t)=>{let n=visit(e,r+1);f(n)||(s[t]=n)}),t[r]=void 0,s}}return e};return visit(e,0)},isAsyncFn:N,isThenable:e=>e&&(isObject(e)||g(e))&&g(e.then)&&g(e.catch)};function AxiosError(e,t,r,s,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),s&&(this.request=s),n&&(this.response=n)}k.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:k.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});let G=AxiosError.prototype,D={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{D[e]={value:e}}),Object.defineProperties(AxiosError,D),Object.defineProperty(G,"isAxiosError",{value:!0}),AxiosError.from=(e,t,r,s,n,i)=>{let a=Object.create(G);return k.toFlatObject(e,a,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e),AxiosError.call(a,e.message,t,r,s,n),a.cause=e,a.name=e.name,i&&Object.assign(a,i),a};var j=r(8764).lW;function isVisitable(e){return k.isPlainObject(e)||k.isArray(e)}function removeBrackets(e){return k.endsWith(e,"[]")?e.slice(0,-2):e}function renderKey(e,t,r){return e?e.concat(t).map(function(e,t){return e=removeBrackets(e),!r&&t?"["+e+"]":e}).join(r?".":""):t}let U=k.toFlatObject(k,{},null,function(e){return/^is[A-Z]/.test(e)});var helpers_toFormData=function(e,t,r){if(!k.isObject(e))throw TypeError("target must be an object");t=t||new FormData,r=k.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!k.isUndefined(t[e])});let s=r.metaTokens,n=r.visitor||defaultVisitor,i=r.dots,a=r.indexes,o=r.Blob||"undefined"!=typeof Blob&&Blob,l=o&&k.isSpecCompliantForm(t);if(!k.isFunction(n))throw TypeError("visitor must be a function");function convertValue(e){if(null===e)return"";if(k.isDate(e))return e.toISOString();if(!l&&k.isBlob(e))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return k.isArrayBuffer(e)||k.isTypedArray(e)?l&&"function"==typeof Blob?new Blob([e]):j.from(e):e}function defaultVisitor(e,r,n){let o=e;if(e&&!n&&"object"==typeof e){if(k.endsWith(r,"{}"))r=s?r:r.slice(0,-2),e=JSON.stringify(e);else{var l;if(k.isArray(e)&&(l=e,k.isArray(l)&&!l.some(isVisitable))||(k.isFileList(e)||k.endsWith(r,"[]"))&&(o=k.toArray(e)))return r=removeBrackets(r),o.forEach(function(e,s){k.isUndefined(e)||null===e||t.append(!0===a?renderKey([r],s,i):null===a?r:r+"[]",convertValue(e))}),!1}}return!!isVisitable(e)||(t.append(renderKey(n,r,i),convertValue(e)),!1)}let c=[],u=Object.assign(U,{defaultVisitor,convertValue,isVisitable});if(!k.isObject(e))throw TypeError("data must be an object");return!function build(e,r){if(!k.isUndefined(e)){if(-1!==c.indexOf(e))throw Error("Circular reference detected in "+r.join("."));c.push(e),k.forEach(e,function(e,s){let i=!(k.isUndefined(e)||null===e)&&n.call(t,e,k.isString(s)?s.trim():s,r,u);!0===i&&build(e,r?r.concat(s):[s])}),c.pop()}}(e),t};function encode(e){let t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\x00"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function AxiosURLSearchParams(e,t){this._pairs=[],e&&helpers_toFormData(e,this,t)}let B=AxiosURLSearchParams.prototype;function buildURL_encode(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(e,t,r){let s;if(!t)return e;let n=r&&r.encode||buildURL_encode,i=r&&r.serialize;if(s=i?i(t,r):k.isURLSearchParams(t)?t.toString():new AxiosURLSearchParams(t,r).toString(n)){let t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}B.append=function(e,t){this._pairs.push([e,t])},B.toString=function(e){let t=e?function(t){return e.call(this,t,encode)}:encode;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};var H=class{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){k.forEach(this.handlers,function(t){null!==t&&e(t)})}},q={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},$="undefined"!=typeof URLSearchParams?URLSearchParams:AxiosURLSearchParams,K="undefined"!=typeof FormData?FormData:null,V="undefined"!=typeof Blob?Blob:null;let z="undefined"!=typeof window&&"undefined"!=typeof document,W=(i="undefined"!=typeof navigator&&navigator.product,z&&0>["ReactNative","NativeScript","NS"].indexOf(i)),X="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,J=z&&window.location.href||"http://localhost";var Y={...l,isBrowser:!0,classes:{URLSearchParams:$,FormData:K,Blob:V},protocols:["http","https","file","blob","url","data"]},helpers_formDataToJSON=function(e){if(k.isFormData(e)&&k.isFunction(e.entries)){let t={};return k.forEachEntry(e,(e,r)=>{!function buildPath(e,t,r,s){let n=e[s++];if("__proto__"===n)return!0;let i=Number.isFinite(+n),a=s>=e.length;if(n=!n&&k.isArray(r)?r.length:n,a)return k.hasOwnProp(r,n)?r[n]=[r[n],t]:r[n]=t,!i;r[n]&&k.isObject(r[n])||(r[n]=[]);let o=buildPath(e,t,r[n],s);return o&&k.isArray(r[n])&&(r[n]=function(e){let t,r;let s={},n=Object.keys(e),i=n.length;for(t=0;t<i;t++)s[r=n[t]]=e[r];return s}(r[n])),!i}(k.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0]),r,t,0)}),t}return null};let Z={transitional:q,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){let r;let s=t.getContentType()||"",n=s.indexOf("application/json")>-1,i=k.isObject(e);i&&k.isHTMLForm(e)&&(e=new FormData(e));let a=k.isFormData(e);if(a)return n?JSON.stringify(helpers_formDataToJSON(e)):e;if(k.isArrayBuffer(e)||k.isBuffer(e)||k.isStream(e)||k.isFile(e)||k.isBlob(e)||k.isReadableStream(e))return e;if(k.isArrayBufferView(e))return e.buffer;if(k.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();if(i){if(s.indexOf("application/x-www-form-urlencoded")>-1){var o,l;return(o=e,l=this.formSerializer,helpers_toFormData(o,new Y.classes.URLSearchParams,Object.assign({visitor:function(e,t,r,s){return Y.isNode&&k.isBuffer(e)?(this.append(t,e.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},l))).toString()}if((r=k.isFileList(e))||s.indexOf("multipart/form-data")>-1){let t=this.env&&this.env.FormData;return helpers_toFormData(r?{"files[]":e}:e,t&&new t,this.formSerializer)}}return i||n?(t.setContentType("application/json",!1),function(e,t,r){if(k.isString(e))try{return(0,JSON.parse)(e),k.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){let t=this.transitional||Z.transitional,r=t&&t.forcedJSONParsing,s="json"===this.responseType;if(k.isResponse(e)||k.isReadableStream(e))return e;if(e&&k.isString(e)&&(r&&!this.responseType||s)){let r=t&&t.silentJSONParsing;try{return JSON.parse(e)}catch(e){if(!r&&s){if("SyntaxError"===e.name)throw AxiosError.from(e,AxiosError.ERR_BAD_RESPONSE,this,null,this.response);throw e}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Y.classes.FormData,Blob:Y.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};k.forEach(["delete","get","head","post","put","patch"],e=>{Z.headers[e]={}});let Q=k.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);var parseHeaders=e=>{let t,r,s;let n={};return e&&e.split("\n").forEach(function(e){s=e.indexOf(":"),t=e.substring(0,s).trim().toLowerCase(),r=e.substring(s+1).trim(),!t||n[t]&&Q[t]||("set-cookie"===t?n[t]?n[t].push(r):n[t]=[r]:n[t]=n[t]?n[t]+", "+r:r)}),n};let ee=Symbol("internals");function normalizeHeader(e){return e&&String(e).trim().toLowerCase()}function normalizeValue(e){return!1===e||null==e?e:k.isArray(e)?e.map(normalizeValue):String(e)}let isValidHeaderName=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function matchHeaderValue(e,t,r,s,n){if(k.isFunction(s))return s.call(this,t,r);if(n&&(t=r),k.isString(t)){if(k.isString(s))return -1!==t.indexOf(s);if(k.isRegExp(s))return s.test(t)}}let AxiosHeaders=class AxiosHeaders{constructor(e){e&&this.set(e)}set(e,t,r){let s=this;function setHeader(e,t,r){let n=normalizeHeader(t);if(!n)throw Error("header name must be a non-empty string");let i=k.findKey(s,n);i&&void 0!==s[i]&&!0!==r&&(void 0!==r||!1===s[i])||(s[i||t]=normalizeValue(e))}let setHeaders=(e,t)=>k.forEach(e,(e,r)=>setHeader(e,r,t));if(k.isPlainObject(e)||e instanceof this.constructor)setHeaders(e,t);else if(k.isString(e)&&(e=e.trim())&&!isValidHeaderName(e))setHeaders(parseHeaders(e),t);else if(k.isHeaders(e))for(let[t,s]of e.entries())setHeader(s,t,r);else null!=e&&setHeader(t,e,r);return this}get(e,t){if(e=normalizeHeader(e)){let r=k.findKey(this,e);if(r){let e=this[r];if(!t)return e;if(!0===t)return function(e){let t;let r=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;for(;t=s.exec(e);)r[t[1]]=t[2];return r}(e);if(k.isFunction(t))return t.call(this,e,r);if(k.isRegExp(t))return t.exec(e);throw TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=normalizeHeader(e)){let r=k.findKey(this,e);return!!(r&&void 0!==this[r]&&(!t||matchHeaderValue(this,this[r],r,t)))}return!1}delete(e,t){let r=this,s=!1;function deleteHeader(e){if(e=normalizeHeader(e)){let n=k.findKey(r,e);n&&(!t||matchHeaderValue(r,r[n],n,t))&&(delete r[n],s=!0)}}return k.isArray(e)?e.forEach(deleteHeader):deleteHeader(e),s}clear(e){let t=Object.keys(this),r=t.length,s=!1;for(;r--;){let n=t[r];(!e||matchHeaderValue(this,this[n],n,e,!0))&&(delete this[n],s=!0)}return s}normalize(e){let t=this,r={};return k.forEach(this,(s,n)=>{let i=k.findKey(r,n);if(i){t[i]=normalizeValue(s),delete t[n];return}let a=e?n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r):String(n).trim();a!==n&&delete t[n],t[a]=normalizeValue(s),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){let t=Object.create(null);return k.forEach(this,(r,s)=>{null!=r&&!1!==r&&(t[s]=e&&k.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){let r=new this(e);return t.forEach(e=>r.set(e)),r}static accessor(e){let t=this[ee]=this[ee]={accessors:{}},r=t.accessors,s=this.prototype;function defineAccessor(e){let t=normalizeHeader(e);r[t]||(!function(e,t){let r=k.toCamelCase(" "+t);["get","set","has"].forEach(s=>{Object.defineProperty(e,s+r,{value:function(e,r,n){return this[s].call(this,t,e,r,n)},configurable:!0})})}(s,e),r[t]=!0)}return k.isArray(e)?e.forEach(defineAccessor):defineAccessor(e),this}};function transformData(e,t){let r=this||Z,s=t||r,n=AxiosHeaders.from(s.headers),i=s.data;return k.forEach(e,function(e){i=e.call(r,i,n.normalize(),t?t.status:void 0)}),n.normalize(),i}function isCancel(e){return!!(e&&e.__CANCEL__)}function CanceledError(e,t,r){AxiosError.call(this,null==e?"canceled":e,AxiosError.ERR_CANCELED,t,r),this.name="CanceledError"}function settle(e,t,r){let s=r.config.validateStatus;!r.status||!s||s(r.status)?e(r):t(new AxiosError("Request failed with status code "+r.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),k.reduceDescriptors(AxiosHeaders.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(e){this[r]=e}}}),k.freezeMethods(AxiosHeaders),k.inherits(CanceledError,AxiosError,{__CANCEL__:!0});var helpers_speedometer=function(e,t){let r;e=e||10;let s=Array(e),n=Array(e),i=0,a=0;return t=void 0!==t?t:1e3,function(o){let l=Date.now(),c=n[a];r||(r=l),s[i]=o,n[i]=l;let u=a,d=0;for(;u!==i;)d+=s[u++],u%=e;if((i=(i+1)%e)===a&&(a=(a+1)%e),l-r<t)return;let h=c&&l-c;return h?Math.round(1e3*d/h):void 0}},helpers_throttle=function(e,t){let r=0,s=1e3/t,n=null;return function(){let t=Date.now();if(this===!0||t-r>s)return n&&(clearTimeout(n),n=null),r=t,e.apply(null,arguments);n||(n=setTimeout(()=>(n=null,r=Date.now(),e.apply(null,arguments)),s-(t-r)))}},progressEventReducer=(e,t,r=3)=>{let s=0,n=helpers_speedometer(50,250);return helpers_throttle(r=>{let i=r.loaded,a=r.lengthComputable?r.total:void 0,o=i-s,l=n(o),c=i<=a;s=i;let u={loaded:i,total:a,progress:a?i/a:void 0,bytes:o,rate:l||void 0,estimated:l&&a&&c?(a-i)/l:void 0,event:r,lengthComputable:null!=a};u[t?"download":"upload"]=!0,e(u)},r)},et=Y.hasStandardBrowserEnv?function(){let e;let t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function resolveURL(e){let s=e;return t&&(r.setAttribute("href",s),s=r.href),r.setAttribute("href",s),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=resolveURL(window.location.href),function(t){let r=k.isString(t)?resolveURL(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0},er=Y.hasStandardBrowserEnv?{write(e,t,r,s,n,i){let a=[e+"="+encodeURIComponent(t)];k.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),k.isString(s)&&a.push("path="+s),k.isString(n)&&a.push("domain="+n),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read(e){let t=document.cookie.match(RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function buildFullPath(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e:t}let headersToObject=e=>e instanceof AxiosHeaders?{...e}:e;function mergeConfig(e,t){t=t||{};let r={};function getMergedValue(e,t,r){return k.isPlainObject(e)&&k.isPlainObject(t)?k.merge.call({caseless:r},e,t):k.isPlainObject(t)?k.merge({},t):k.isArray(t)?t.slice():t}function mergeDeepProperties(e,t,r){return k.isUndefined(t)?k.isUndefined(e)?void 0:getMergedValue(void 0,e,r):getMergedValue(e,t,r)}function valueFromConfig2(e,t){if(!k.isUndefined(t))return getMergedValue(void 0,t)}function defaultToConfig2(e,t){return k.isUndefined(t)?k.isUndefined(e)?void 0:getMergedValue(void 0,e):getMergedValue(void 0,t)}function mergeDirectKeys(r,s,n){return n in t?getMergedValue(r,s):n in e?getMergedValue(void 0,r):void 0}let s={url:valueFromConfig2,method:valueFromConfig2,data:valueFromConfig2,baseURL:defaultToConfig2,transformRequest:defaultToConfig2,transformResponse:defaultToConfig2,paramsSerializer:defaultToConfig2,timeout:defaultToConfig2,timeoutMessage:defaultToConfig2,withCredentials:defaultToConfig2,withXSRFToken:defaultToConfig2,adapter:defaultToConfig2,responseType:defaultToConfig2,xsrfCookieName:defaultToConfig2,xsrfHeaderName:defaultToConfig2,onUploadProgress:defaultToConfig2,onDownloadProgress:defaultToConfig2,decompress:defaultToConfig2,maxContentLength:defaultToConfig2,maxBodyLength:defaultToConfig2,beforeRedirect:defaultToConfig2,transport:defaultToConfig2,httpAgent:defaultToConfig2,httpsAgent:defaultToConfig2,cancelToken:defaultToConfig2,socketPath:defaultToConfig2,responseEncoding:defaultToConfig2,validateStatus:mergeDirectKeys,headers:(e,t)=>mergeDeepProperties(headersToObject(e),headersToObject(t),!0)};return k.forEach(Object.keys(Object.assign({},e,t)),function(n){let i=s[n]||mergeDeepProperties,a=i(e[n],t[n],n);k.isUndefined(a)&&i!==mergeDirectKeys||(r[n]=a)}),r}var resolveConfig=e=>{let t;let r=mergeConfig({},e),{data:s,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:a,headers:o,auth:l}=r;if(r.headers=o=AxiosHeaders.from(o),r.url=buildURL(buildFullPath(r.baseURL,r.url),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),k.isFormData(s)){if(Y.hasStandardBrowserEnv||Y.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(!1!==(t=o.getContentType())){let[e,...r]=t?t.split(";").map(e=>e.trim()).filter(Boolean):[];o.setContentType([e||"multipart/form-data",...r].join("; "))}}if(Y.hasStandardBrowserEnv&&(n&&k.isFunction(n)&&(n=n(r)),n||!1!==n&&et(r.url))){let e=i&&a&&er.read(a);e&&o.set(i,e)}return r};let es="undefined"!=typeof XMLHttpRequest;var en=es&&function(e){return new Promise(function(t,r){let s;let n=resolveConfig(e),i=n.data,a=AxiosHeaders.from(n.headers).normalize(),{responseType:o}=n;function done(){n.cancelToken&&n.cancelToken.unsubscribe(s),n.signal&&n.signal.removeEventListener("abort",s)}let l=new XMLHttpRequest;function onloadend(){if(!l)return;let s=AxiosHeaders.from("getAllResponseHeaders"in l&&l.getAllResponseHeaders()),n=o&&"text"!==o&&"json"!==o?l.response:l.responseText,i={data:n,status:l.status,statusText:l.statusText,headers:s,config:e,request:l};settle(function(e){t(e),done()},function(e){r(e),done()},i),l=null}l.open(n.method.toUpperCase(),n.url,!0),l.timeout=n.timeout,"onloadend"in l?l.onloadend=onloadend:l.onreadystatechange=function(){l&&4===l.readyState&&(0!==l.status||l.responseURL&&0===l.responseURL.indexOf("file:"))&&setTimeout(onloadend)},l.onabort=function(){l&&(r(new AxiosError("Request aborted",AxiosError.ECONNABORTED,n,l)),l=null)},l.onerror=function(){r(new AxiosError("Network Error",AxiosError.ERR_NETWORK,n,l)),l=null},l.ontimeout=function(){let e=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded",t=n.transitional||q;n.timeoutErrorMessage&&(e=n.timeoutErrorMessage),r(new AxiosError(e,t.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,n,l)),l=null},void 0===i&&a.setContentType(null),"setRequestHeader"in l&&k.forEach(a.toJSON(),function(e,t){l.setRequestHeader(t,e)}),k.isUndefined(n.withCredentials)||(l.withCredentials=!!n.withCredentials),o&&"json"!==o&&(l.responseType=n.responseType),"function"==typeof n.onDownloadProgress&&l.addEventListener("progress",progressEventReducer(n.onDownloadProgress,!0)),"function"==typeof n.onUploadProgress&&l.upload&&l.upload.addEventListener("progress",progressEventReducer(n.onUploadProgress)),(n.cancelToken||n.signal)&&(s=t=>{l&&(r(!t||t.type?new CanceledError(null,e,l):t),l.abort(),l=null)},n.cancelToken&&n.cancelToken.subscribe(s),n.signal&&(n.signal.aborted?s():n.signal.addEventListener("abort",s)));let c=function(e){let t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(n.url);if(c&&-1===Y.protocols.indexOf(c)){r(new AxiosError("Unsupported protocol "+c+":",AxiosError.ERR_BAD_REQUEST,e));return}l.send(i||null)})},helpers_composeSignals=(e,t)=>{let r,s=new AbortController,onabort=function(e){if(!r){r=!0,unsubscribe();let t=e instanceof Error?e:this.reason;s.abort(t instanceof AxiosError?t:new CanceledError(t instanceof Error?t.message:t))}},n=t&&setTimeout(()=>{onabort(new AxiosError(`timeout ${t} of ms exceeded`,AxiosError.ETIMEDOUT))},t),unsubscribe=()=>{e&&(n&&clearTimeout(n),n=null,e.forEach(e=>{e&&(e.removeEventListener?e.removeEventListener("abort",onabort):e.unsubscribe(onabort))}),e=null)};e.forEach(e=>e&&e.addEventListener&&e.addEventListener("abort",onabort));let{signal:i}=s;return i.unsubscribe=unsubscribe,[i,()=>{n&&clearTimeout(n),n=null}]};let streamChunk=function*(e,t){let r,s=e.byteLength;if(!t||s<t){yield e;return}let n=0;for(;n<s;)r=n+t,yield e.slice(n,r),n=r},readBytes=async function*(e,t,r){for await(let s of e)yield*streamChunk(ArrayBuffer.isView(s)?s:await r(String(s)),t)},trackStream=(e,t,r,s,n)=>{let i=readBytes(e,t,n),a=0;return new ReadableStream({type:"bytes",async pull(e){let{done:t,value:n}=await i.next();if(t){e.close(),s();return}let o=n.byteLength;r&&r(a+=o),e.enqueue(new Uint8Array(n))},cancel:e=>(s(e),i.return())},{highWaterMark:2})},fetchProgressDecorator=(e,t)=>{let r=null!=e;return s=>setTimeout(()=>t({lengthComputable:r,total:e,loaded:s}))},ei="function"==typeof fetch&&"function"==typeof Request&&"function"==typeof Response,ea=ei&&"function"==typeof ReadableStream,eo=ei&&("function"==typeof TextEncoder?(a=new TextEncoder,e=>a.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer())),el=ea&&(()=>{let e=!1,t=new Request(Y.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})(),ec=ea&&!!(()=>{try{return k.isReadableStream(new Response("").body)}catch(e){}})(),eu={stream:ec&&(e=>e.body)};ei&&(o=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(e=>{eu[e]||(eu[e]=k.isFunction(o[e])?t=>t[e]():(t,r)=>{throw new AxiosError(`Response type '${e}' is not supported`,AxiosError.ERR_NOT_SUPPORT,r)})}));let getBodyLength=async e=>null==e?0:k.isBlob(e)?e.size:k.isSpecCompliantForm(e)?(await new Request(e).arrayBuffer()).byteLength:k.isArrayBufferView(e)?e.byteLength:(k.isURLSearchParams(e)&&(e+=""),k.isString(e))?(await eo(e)).byteLength:void 0,resolveBodyLength=async(e,t)=>{let r=k.toFiniteNumber(e.getContentLength());return null==r?getBodyLength(t):r};var ed=ei&&(async e=>{let t,r,s,{url:n,method:i,data:a,signal:o,cancelToken:l,timeout:c,onDownloadProgress:u,onUploadProgress:d,responseType:h,headers:f,withCredentials:p="same-origin",fetchOptions:m}=resolveConfig(e);h=h?(h+"").toLowerCase():"text";let[g,A]=o||l||c?helpers_composeSignals([o,l],c):[],onFinish=()=>{t||setTimeout(()=>{g&&g.unsubscribe()}),t=!0};try{if(d&&el&&"get"!==i&&"head"!==i&&0!==(s=await resolveBodyLength(f,a))){let e,t=new Request(n,{method:"POST",body:a,duplex:"half"});k.isFormData(a)&&(e=t.headers.get("content-type"))&&f.setContentType(e),t.body&&(a=trackStream(t.body,65536,fetchProgressDecorator(s,progressEventReducer(d)),null,eo))}k.isString(p)||(p=p?"cors":"omit"),r=new Request(n,{...m,signal:g,method:i.toUpperCase(),headers:f.normalize().toJSON(),body:a,duplex:"half",withCredentials:p});let t=await fetch(r),o=ec&&("stream"===h||"response"===h);if(ec&&(u||o)){let e={};["status","statusText","headers"].forEach(r=>{e[r]=t[r]});let r=k.toFiniteNumber(t.headers.get("content-length"));t=new Response(trackStream(t.body,65536,u&&fetchProgressDecorator(r,progressEventReducer(u,!0)),o&&onFinish,eo),e)}h=h||"text";let l=await eu[k.findKey(eu,h)||"text"](t,e);return o||onFinish(),A&&A(),await new Promise((s,n)=>{settle(s,n,{data:l,headers:AxiosHeaders.from(t.headers),status:t.status,statusText:t.statusText,config:e,request:r})})}catch(t){if(onFinish(),t&&"TypeError"===t.name&&/fetch/i.test(t.message))throw Object.assign(new AxiosError("Network Error",AxiosError.ERR_NETWORK,e,r),{cause:t.cause||t});throw AxiosError.from(t,t&&t.code,e,r)}});let eh={http:null,xhr:en,fetch:ed};k.forEach(eh,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(e){}Object.defineProperty(e,"adapterName",{value:t})}});let renderReason=e=>`- ${e}`,isResolvedHandle=e=>k.isFunction(e)||null===e||!1===e;var ef={getAdapter:e=>{let t,r;e=k.isArray(e)?e:[e];let{length:s}=e,n={};for(let i=0;i<s;i++){let s;if(r=t=e[i],!isResolvedHandle(t)&&void 0===(r=eh[(s=String(t)).toLowerCase()]))throw new AxiosError(`Unknown adapter '${s}'`);if(r)break;n[s||"#"+i]=r}if(!r){let e=Object.entries(n).map(([e,t])=>`adapter ${e} `+(!1===t?"is not supported by the environment":"is not available in the build")),t=s?e.length>1?"since :\n"+e.map(renderReason).join("\n"):" "+renderReason(e[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+t,"ERR_NOT_SUPPORT")}return r},adapters:eh};function throwIfCancellationRequested(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new CanceledError(null,e)}function dispatchRequest(e){throwIfCancellationRequested(e),e.headers=AxiosHeaders.from(e.headers),e.data=transformData.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);let t=ef.getAdapter(e.adapter||Z.adapter);return t(e).then(function(t){return throwIfCancellationRequested(e),t.data=transformData.call(e,e.transformResponse,t),t.headers=AxiosHeaders.from(t.headers),t},function(t){return!isCancel(t)&&(throwIfCancellationRequested(e),t&&t.response&&(t.response.data=transformData.call(e,e.transformResponse,t.response),t.response.headers=AxiosHeaders.from(t.response.headers))),Promise.reject(t)})}let ep="1.7.2",em={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{em[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});let eg={};em.transitional=function(e,t,r){function formatMessage(e,t){return"[Axios v"+ep+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return(r,s,n)=>{if(!1===e)throw new AxiosError(formatMessage(s," has been removed"+(t?" in "+t:"")),AxiosError.ERR_DEPRECATED);return t&&!eg[s]&&(eg[s]=!0,console.warn(formatMessage(s," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,s,n)}};var eA={assertOptions:function(e,t,r){if("object"!=typeof e)throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);let s=Object.keys(e),n=s.length;for(;n-- >0;){let i=s[n],a=t[i];if(a){let t=e[i],r=void 0===t||a(t,i,e);if(!0!==r)throw new AxiosError("option "+i+" must be "+r,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(!0!==r)throw new AxiosError("Unknown option "+i,AxiosError.ERR_BAD_OPTION)}},validators:em};let eb=eA.validators;let Axios=class Axios{constructor(e){this.defaults=e,this.interceptors={request:new H,response:new H}}async request(e,t){try{return await this._request(e,t)}catch(e){if(e instanceof Error){let t;Error.captureStackTrace?Error.captureStackTrace(t={}):t=Error();let r=t.stack?t.stack.replace(/^.+\n/,""):"";try{e.stack?r&&!String(e.stack).endsWith(r.replace(/^.+\n.+\n/,""))&&(e.stack+="\n"+r):e.stack=r}catch(e){}}throw e}}_request(e,t){let r,s;"string"==typeof e?(t=t||{}).url=e:t=e||{},t=mergeConfig(this.defaults,t);let{transitional:n,paramsSerializer:i,headers:a}=t;void 0!==n&&eA.assertOptions(n,{silentJSONParsing:eb.transitional(eb.boolean),forcedJSONParsing:eb.transitional(eb.boolean),clarifyTimeoutError:eb.transitional(eb.boolean)},!1),null!=i&&(k.isFunction(i)?t.paramsSerializer={serialize:i}:eA.assertOptions(i,{encode:eb.function,serialize:eb.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=a&&k.merge(a.common,a[t.method]);a&&k.forEach(["delete","get","head","post","put","patch","common"],e=>{delete a[e]}),t.headers=AxiosHeaders.concat(o,a);let l=[],c=!0;this.interceptors.request.forEach(function(e){("function"!=typeof e.runWhen||!1!==e.runWhen(t))&&(c=c&&e.synchronous,l.unshift(e.fulfilled,e.rejected))});let u=[];this.interceptors.response.forEach(function(e){u.push(e.fulfilled,e.rejected)});let d=0;if(!c){let e=[dispatchRequest.bind(this),void 0];for(e.unshift.apply(e,l),e.push.apply(e,u),s=e.length,r=Promise.resolve(t);d<s;)r=r.then(e[d++],e[d++]);return r}s=l.length;let h=t;for(d=0;d<s;){let e=l[d++],t=l[d++];try{h=e(h)}catch(e){t.call(this,e);break}}try{r=dispatchRequest.call(this,h)}catch(e){return Promise.reject(e)}for(d=0,s=u.length;d<s;)r=r.then(u[d++],u[d++]);return r}getUri(e){e=mergeConfig(this.defaults,e);let t=buildFullPath(e.baseURL,e.url);return buildURL(t,e.params,e.paramsSerializer)}};k.forEach(["delete","get","head","options"],function(e){Axios.prototype[e]=function(t,r){return this.request(mergeConfig(r||{},{method:e,url:t,data:(r||{}).data}))}}),k.forEach(["post","put","patch"],function(e){function generateHTTPMethod(t){return function(r,s,n){return this.request(mergeConfig(n||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:r,data:s}))}}Axios.prototype[e]=generateHTTPMethod(),Axios.prototype[e+"Form"]=generateHTTPMethod(!0)});let CancelToken=class CancelToken{constructor(e){let t;if("function"!=typeof e)throw TypeError("executor must be a function.");this.promise=new Promise(function(e){t=e});let r=this;this.promise.then(e=>{if(!r._listeners)return;let t=r._listeners.length;for(;t-- >0;)r._listeners[t](e);r._listeners=null}),this.promise.then=e=>{let t;let s=new Promise(e=>{r.subscribe(e),t=e}).then(e);return s.cancel=function(){r.unsubscribe(t)},s},e(function(e,s,n){r.reason||(r.reason=new CanceledError(e,s,n),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;let t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}static source(){let e;let t=new CancelToken(function(t){e=t});return{token:t,cancel:e}}};let ey={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ey).forEach(([e,t])=>{ey[t]=e});let eE=function createInstance(e){let t=new Axios(e),r=bind(Axios.prototype.request,t);return k.extend(r,Axios.prototype,t,{allOwnKeys:!0}),k.extend(r,t,null,{allOwnKeys:!0}),r.create=function(t){return createInstance(mergeConfig(e,t))},r}(Z);eE.Axios=Axios,eE.CanceledError=CanceledError,eE.CancelToken=CancelToken,eE.isCancel=isCancel,eE.VERSION=ep,eE.toFormData=helpers_toFormData,eE.AxiosError=AxiosError,eE.Cancel=eE.CanceledError,eE.all=function(e){return Promise.all(e)},eE.spread=function(e){return function(t){return e.apply(null,t)}},eE.isAxiosError=function(e){return k.isObject(e)&&!0===e.isAxiosError},eE.mergeConfig=mergeConfig,eE.AxiosHeaders=AxiosHeaders,eE.formToJSON=e=>helpers_formDataToJSON(k.isHTMLForm(e)?new FormData(e):e),eE.getAdapter=ef.getAdapter,eE.HttpStatusCode=ey,eE.default=eE;var e_=eE},6542:function(e,t,r){"use strict";let s,n,i,a,o,l,c,u,d,h;r.d(t,{Pp:function(){return OpenAI}});var f,p,m,g,A,b,y,E,_,v,w,R,S,T,P,C,x,I,O,F,M,L,N,k,G,D,j,U,B,H,q,$,K,V,z,W,X,J,Y,Z,Q,ee,et,er,es,en,ei,ea,eo,el,ec,eu,ed,eh,ef,ep,em,eg,eA,eb,ey,eE,e_,ev,ew,eR,eS,eT,eP,eC,ex={};r.r(ex),r.d(ex,{APIConnectionError:function(){return APIConnectionError},APIConnectionTimeoutError:function(){return APIConnectionTimeoutError},APIError:function(){return APIError},APIUserAbortError:function(){return APIUserAbortError},AuthenticationError:function(){return AuthenticationError},BadRequestError:function(){return BadRequestError},ConflictError:function(){return ConflictError},InternalServerError:function(){return InternalServerError},NotFoundError:function(){return NotFoundError},OpenAIError:function(){return error_OpenAIError},PermissionDeniedError:function(){return PermissionDeniedError},RateLimitError:function(){return RateLimitError},UnprocessableEntityError:function(){return UnprocessableEntityError}});let eI="4.51.0",eO=!1;let MultipartBody=class MultipartBody{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}};n||function(e,t={auto:!1}){if(eO)throw Error(`you must \`import 'openai/shims/${e.kind}'\` before importing anything else from openai`);if(n)throw Error(`can't \`import 'openai/shims/${e.kind}'\` after \`import 'openai/shims/${n}'\``);eO=t.auto,n=e.kind,i=e.fetch,e.Request,e.Response,e.Headers,a=e.FormData,e.Blob,o=e.File,l=e.ReadableStream,c=e.getMultipartRequestOptions,u=e.getDefaultAgent,d=e.fileFromPath,h=e.isFsReadStream}(function({manuallyImported:e}={}){let t,r,s,n;let i=e?"You may need to use polyfills":`Add one of these imports before your first \`import … from 'openai'\`:
- \`import 'openai/shims/node'\` (if you're running on Node)
- \`import 'openai/shims/web'\` (otherwise)
`;try{t=fetch,r=Request,s=Response,n=Headers}catch(e){throw Error(`this environment is missing the following Web Fetch API type: ${e.message}. ${i}`)}return{kind:"web",fetch:t,Request:r,Response:s,Headers:n,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${i}`)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${i}`)}},File:"undefined"!=typeof File?File:class{constructor(){throw Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${i}`)}},ReadableStream:"undefined"!=typeof ReadableStream?ReadableStream:class{constructor(){throw Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${i}`)}},getMultipartRequestOptions:async(e,t)=>({...t,body:new MultipartBody(e)}),getDefaultAgent:e=>void 0,fileFromPath:()=>{throw Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:e=>!1}}(),{auto:!0});let error_OpenAIError=class error_OpenAIError extends Error{};let APIError=class APIError extends error_OpenAIError{constructor(e,t,r,s){super(`${APIError.makeMessage(e,t,r)}`),this.status=e,this.headers=s,this.request_id=s?.["x-request-id"],this.error=t,this.code=t?.code,this.param=t?.param,this.type=t?.type}static makeMessage(e,t,r){let s=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,r,s){if(!e)return new APIConnectionError({cause:castToError(t)});let n=t?.error;return 400===e?new BadRequestError(e,n,r,s):401===e?new AuthenticationError(e,n,r,s):403===e?new PermissionDeniedError(e,n,r,s):404===e?new NotFoundError(e,n,r,s):409===e?new ConflictError(e,n,r,s):422===e?new UnprocessableEntityError(e,n,r,s):429===e?new RateLimitError(e,n,r,s):e>=500?new InternalServerError(e,n,r,s):new APIError(e,n,r,s)}};let APIUserAbortError=class APIUserAbortError extends APIError{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}};let APIConnectionError=class APIConnectionError extends APIError{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,t&&(this.cause=t)}};let APIConnectionTimeoutError=class APIConnectionTimeoutError extends APIConnectionError{constructor({message:e}={}){super({message:e??"Request timed out."})}};let BadRequestError=class BadRequestError extends APIError{constructor(){super(...arguments),this.status=400}};let AuthenticationError=class AuthenticationError extends APIError{constructor(){super(...arguments),this.status=401}};let PermissionDeniedError=class PermissionDeniedError extends APIError{constructor(){super(...arguments),this.status=403}};let NotFoundError=class NotFoundError extends APIError{constructor(){super(...arguments),this.status=404}};let ConflictError=class ConflictError extends APIError{constructor(){super(...arguments),this.status=409}};let UnprocessableEntityError=class UnprocessableEntityError extends APIError{constructor(){super(...arguments),this.status=422}};let RateLimitError=class RateLimitError extends APIError{constructor(){super(...arguments),this.status=429}};let InternalServerError=class InternalServerError extends APIError{};var eF=r(8764).lW;let Stream=class Stream{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;async function*iterator(){if(r)throw Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let s=!1;try{for await(let r of _iterSSEMessages(e,t))if(!s){if(r.data.startsWith("[DONE]")){s=!0;continue}if(null===r.event){let e;try{e=JSON.parse(r.data)}catch(e){throw console.error("Could not parse message into JSON:",r.data),console.error("From chunk:",r.raw),e}if(e&&e.error)throw new APIError(void 0,e.error,void 0,void 0);yield e}else{let e;try{e=JSON.parse(r.data)}catch(e){throw console.error("Could not parse message into JSON:",r.data),console.error("From chunk:",r.raw),e}if("error"==r.event)throw new APIError(void 0,e.error,e.message,void 0);yield{event:r.event,data:e}}}s=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{s||t.abort()}}return new Stream(iterator,t)}static fromReadableStream(e,t){let r=!1;async function*iterLines(){let t=new LineDecoder,r=readableStreamAsyncIterable(e);for await(let e of r)for(let r of t.decode(e))yield r;for(let e of t.flush())yield e}async function*iterator(){if(r)throw Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let e=!1;try{for await(let t of iterLines())!e&&t&&(yield JSON.parse(t));e=!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return;throw e}finally{e||t.abort()}}return new Stream(iterator,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){let e=[],t=[],r=this.iterator(),teeIterator=s=>({next:()=>{if(0===s.length){let s=r.next();e.push(s),t.push(s)}return s.shift()}});return[new Stream(()=>teeIterator(e),this.controller),new Stream(()=>teeIterator(t),this.controller)]}toReadableStream(){let e;let t=this,r=new TextEncoder;return new l({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{let{value:s,done:n}=await e.next();if(n)return t.close();let i=r.encode(JSON.stringify(s)+"\n");t.enqueue(i)}catch(e){t.error(e)}},async cancel(){await e.return?.()}})}};async function*_iterSSEMessages(e,t){if(!e.body)throw t.abort(),new error_OpenAIError("Attempted to iterate over a response with no body");let r=new SSEDecoder,s=new LineDecoder,n=readableStreamAsyncIterable(e.body);for await(let e of iterSSEChunks(n))for(let t of s.decode(e)){let e=r.decode(t);e&&(yield e)}for(let e of s.flush()){let t=r.decode(e);t&&(yield t)}}async function*iterSSEChunks(e){let t=new Uint8Array;for await(let r of e){let e;if(null==r)continue;let s=r instanceof ArrayBuffer?new Uint8Array(r):"string"==typeof r?new TextEncoder().encode(r):r,n=new Uint8Array(t.length+s.length);for(n.set(t),n.set(s,t.length),t=n;-1!==(e=function(e){for(let t=0;t<e.length-2;t++){if(10===e[t]&&10===e[t+1]||13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return -1}(t));)yield t.slice(0,e),t=t.slice(e)}t.length>0&&(yield t)}let SSEDecoder=class SSEDecoder{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,s]=function(e,t){let r=e.indexOf(t);return -1!==r?[e.substring(0,r),t,e.substring(r+t.length)]:[e,"",""]}(e,":");return s.startsWith(" ")&&(s=s.substring(1)),"event"===t?this.event=s:"data"===t&&this.data.push(s),null}};let LineDecoder=class LineDecoder{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];let r=LineDecoder.NEWLINE_CHARS.has(t[t.length-1]||""),s=t.split(LineDecoder.NEWLINE_REGEXP);return(r&&s.pop(),1!==s.length||r)?(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),r||(this.buffer=[s.pop()||""]),s):(this.buffer.push(s[0]),[])}decodeText(e){if(null==e)return"";if("string"==typeof e)return e;if(void 0!==eF){if(e instanceof eF)return e.toString();if(e instanceof Uint8Array)return eF.from(e).toString();throw new error_OpenAIError(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"!=typeof TextDecoder){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new error_OpenAIError(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new error_OpenAIError("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];let e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}};function readableStreamAsyncIterable(e){if(e[Symbol.asyncIterator])return e;let t=e.getReader();return{async next(){try{let e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){let e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}LineDecoder.NEWLINE_CHARS=new Set(["\n","\r"]),LineDecoder.NEWLINE_REGEXP=/\r\n|[\n\r]/g;var eM=r(8764).lW;let isResponseLike=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob,isFileLike=e=>null!=e&&"object"==typeof e&&"string"==typeof e.name&&"number"==typeof e.lastModified&&isBlobLike(e),isBlobLike=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer,isUploadable=e=>isFileLike(e)||isResponseLike(e)||h(e);async function toFile(e,t,r){var s;if(e=await e,r??(r=isFileLike(e)?{lastModified:e.lastModified,type:e.type}:{}),isResponseLike(e)){let s=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new o([s],t,r)}let n=await getBytes(e);if(t||(t=(getStringFromMaybeBuffer((s=e).name)||getStringFromMaybeBuffer(s.filename)||getStringFromMaybeBuffer(s.path)?.split(/[\\/]/).pop())??"unknown_file"),!r.type){let e=n[0]?.type;"string"==typeof e&&(r={...r,type:e})}return new o(n,t,r)}async function getBytes(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(isBlobLike(e))t.push(await e.arrayBuffer());else if(isAsyncIterableIterator(e))for await(let r of e)t.push(r);else throw Error(`Unexpected data type: ${typeof e}; constructor: ${e?.constructor?.name}; props: ${function(e){let t=Object.getOwnPropertyNames(e);return`[${t.map(e=>`"${e}"`).join(", ")}]`}(e)}`);return t}let getStringFromMaybeBuffer=e=>"string"==typeof e?e:void 0!==eM&&e instanceof eM?String(e):void 0,isAsyncIterableIterator=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],isMultipartBody=e=>e&&"object"==typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag],multipartFormRequestOptions=async e=>{let t=await createForm(e.body);return c(t,e)},createForm=async e=>{let t=new a;return await Promise.all(Object.entries(e||{}).map(([e,r])=>addFormValue(t,e,r))),t},addFormValue=async(e,t,r)=>{if(void 0!==r){if(null==r)throw TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof r||"number"==typeof r||"boolean"==typeof r)e.append(t,String(r));else if(isUploadable(r)){let s=await toFile(r);e.append(t,s)}else if(Array.isArray(r))await Promise.all(r.map(r=>addFormValue(e,t+"[]",r)));else if("object"==typeof r)await Promise.all(Object.entries(r).map(([r,s])=>addFormValue(e,`${t}[${r}]`,s)));else throw TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${r} instead`)}};var eL=r(8764).lW,eN=r(3454),__classPrivateFieldSet=function(e,t,r,s,n){if("m"===s)throw TypeError("Private method is not writable");if("a"===s&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,r):n?n.value=r:t.set(e,r),r},__classPrivateFieldGet=function(e,t,r,s){if("a"===r&&!s)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)};async function defaultParseResponse(e){let{response:t}=e;if(e.options.stream)return(debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass)?e.options.__streamClass.fromSSEResponse(t,e.controller):Stream.fromSSEResponse(t,e.controller);if(204===t.status)return null;if(e.options.__binaryResponse)return t;let r=t.headers.get("content-type"),s=r?.includes("application/json")||r?.includes("application/vnd.api+json");if(s){let e=await t.json();return debug("response",t.status,t.url,t.headers,e),e}let n=await t.text();return debug("response",t.status,t.url,t.headers,n),n}let APIPromise=class APIPromise extends Promise{constructor(e,t=defaultParseResponse){super(e=>{e(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new APIPromise(this.responsePromise,async t=>e(await this.parseResponse(t)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}};let APIClient=class APIClient{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e5,httpAgent:s,fetch:n}){this.baseURL=e,this.maxRetries=validatePositiveInteger("maxRetries",t),this.timeout=validatePositiveInteger("timeout",r),this.httpAgent=s,this.fetch=n??i}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...getPlatformHeaders(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${uuid4()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async r=>{let s=r&&isBlobLike(r?.body)?new DataView(await r.body.arrayBuffer()):r?.body instanceof DataView?r.body:r?.body instanceof ArrayBuffer?new DataView(r.body):r&&ArrayBuffer.isView(r?.body)?new DataView(r.body.buffer):r?.body;return{method:e,path:t,...r,body:s}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if("string"==typeof e){if(void 0!==eL)return eL.byteLength(e,"utf8").toString();if("undefined"!=typeof TextEncoder){let t=new TextEncoder,r=t.encode(e);return r.length.toString()}}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e){let{method:t,path:r,query:s,headers:n={}}=e,i=ArrayBuffer.isView(e.body)||e.__binaryRequest&&"string"==typeof e.body?e.body:isMultipartBody(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,a=this.calculateContentLength(i),o=this.buildURL(r,s);"timeout"in e&&validatePositiveInteger("timeout",e.timeout);let l=e.timeout??this.timeout,c=e.httpAgent??this.httpAgent??u(o),d=l+1e3;"number"==typeof c?.options?.timeout&&d>(c.options.timeout??0)&&(c.options.timeout=d),this.idempotencyHeader&&"get"!==t&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),n[this.idempotencyHeader]=e.idempotencyKey);let h=this.buildHeaders({options:e,headers:n,contentLength:a}),f={method:t,...i&&{body:i},headers:h,...c&&{agent:c},signal:e.signal??null};return{req:f,url:o,timeout:l}}buildHeaders({options:e,headers:t,contentLength:r}){let s={};r&&(s["content-length"]=r);let i=this.defaultHeaders(e);return applyHeadersMut(s,i),applyHeadersMut(s,t),isMultipartBody(e.body)&&"node"!==n&&delete s["content-type"],this.validateHeaders(s,t),s}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(e=>[...e])):{...e}:{}}makeStatusError(e,t,r,s){return APIError.generate(e,t,r,s)}request(e,t=null){return new APIPromise(this.makeRequest(e,t))}async makeRequest(e,t){let r=await e;null==t&&(t=r.maxRetries??this.maxRetries),await this.prepareOptions(r);let{req:s,url:n,timeout:i}=this.buildRequest(r);if(await this.prepareRequest(s,{url:n,options:r}),debug("request",n,r,s.headers),r.signal?.aborted)throw new APIUserAbortError;let a=new AbortController,o=await this.fetchWithTimeout(n,s,i,a).catch(castToError);if(o instanceof Error){if(r.signal?.aborted)throw new APIUserAbortError;if(t)return this.retryRequest(r,t);if("AbortError"===o.name)throw new APIConnectionTimeoutError;throw new APIConnectionError({cause:o})}let l=createResponseHeaders(o.headers);if(!o.ok){if(t&&this.shouldRetry(o)){let e=`retrying, ${t} attempts remaining`;return debug(`response (error; ${e})`,o.status,n,l),this.retryRequest(r,t,l)}let e=await o.text().catch(e=>castToError(e).message),s=safeJSON(e),i=s?void 0:e,a=t?"(error; no more retries left)":"(error; not retryable)";debug(`response (error; ${a})`,o.status,n,l,i);let c=this.makeStatusError(o.status,s,i,l);throw c}return{response:o,options:r,controller:a}}requestAPIList(e,t){let r=this.makeRequest(t,null);return new PagePromise(this,r,e)}buildURL(e,t){let r=new URL(isAbsoluteURL(e)?e:this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return isEmptyObj(s)||(t={...s,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([e,t])=>void 0!==t).map(([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new error_OpenAIError(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,s){let{signal:n,...i}=t||{};n&&n.addEventListener("abort",()=>s.abort());let a=setTimeout(()=>s.abort(),r);return this.getRequestClient().fetch.call(void 0,e,{signal:s.signal,...i}).finally(()=>{clearTimeout(a)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||e.status>=500)}async retryRequest(e,t,r){let s;let n=r?.["retry-after-ms"];if(n){let e=parseFloat(n);Number.isNaN(e)||(s=e)}let i=r?.["retry-after"];if(i&&!s){let e=parseFloat(i);s=Number.isNaN(e)?Date.parse(i)-Date.now():1e3*e}if(!(s&&0<=s&&s<6e4)){let r=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,r)}return await sleep(s),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3}getUserAgent(){return`${this.constructor.name}/JS ${eI}`}};let AbstractPage=class AbstractPage{constructor(e,t,r,s){_.set(this,void 0),__classPrivateFieldSet(this,_,e,"f"),this.options=s,this.response=t,this.body=r}hasNextPage(){let e=this.getPaginatedItems();return!!e.length&&null!=this.nextPageInfo()}async getNextPage(){let e=this.nextPageInfo();if(!e)throw new error_OpenAIError("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");let t={...this.options};if("params"in e&&"object"==typeof t.query)t.query={...t.query,...e.params};else if("url"in e){let r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(let[t,s]of r)e.url.searchParams.set(t,s);t.query=void 0,t.path=e.url.toString()}return await __classPrivateFieldGet(this,_,"f").requestAPIList(this.constructor,t)}async *iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async *[(_=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let t of e.getPaginatedItems())yield t}};let PagePromise=class PagePromise extends APIPromise{constructor(e,t,r){super(t,async t=>new r(e,t.response,await defaultParseResponse(t),t.options))}async *[Symbol.asyncIterator](){let e=await this;for await(let t of e)yield t}};let createResponseHeaders=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){let r=t.toString();return e[r.toLowerCase()]||e[r]}}),ek={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},isRequestOptions=e=>"object"==typeof e&&null!==e&&!isEmptyObj(e)&&Object.keys(e).every(e=>hasOwn(ek,e)),getPlatformProperties=()=>{if("undefined"!=typeof Deno&&null!=Deno.build)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eI,"X-Stainless-OS":normalizePlatform(Deno.build.os),"X-Stainless-Arch":normalizeArch(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eI,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":eN.version};if("[object process]"===Object.prototype.toString.call(void 0!==eN?eN:0))return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eI,"X-Stainless-OS":normalizePlatform(eN.platform),"X-Stainless-Arch":normalizeArch(eN.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":eN.version};let e=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let r=t.exec(navigator.userAgent);if(r){let t=r[1]||0,s=r[2]||0,n=r[3]||0;return{browser:e,version:`${t}.${s}.${n}`}}}return null}();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eI,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eI,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}},normalizeArch=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",normalizePlatform=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown",getPlatformHeaders=()=>s??(s=getPlatformProperties()),safeJSON=e=>{try{return JSON.parse(e)}catch(e){return}},eG=RegExp("^(?:[a-z]+:)?//","i"),isAbsoluteURL=e=>eG.test(e),sleep=e=>new Promise(t=>setTimeout(t,e)),validatePositiveInteger=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new error_OpenAIError(`${e} must be an integer`);if(t<0)throw new error_OpenAIError(`${e} must be a positive integer`);return t},castToError=e=>e instanceof Error?e:Error(e),readEnv=e=>void 0!==eN?eN.env?.[e]?.trim()??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(e)?.trim():void 0;function isEmptyObj(e){if(!e)return!0;for(let t in e)return!1;return!0}function hasOwn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function applyHeadersMut(e,t){for(let r in t){if(!hasOwn(t,r))continue;let s=r.toLowerCase();if(!s)continue;let n=t[r];null===n?delete e[s]:void 0!==n&&(e[s]=n)}}function debug(e,...t){void 0!==eN&&eN?.env?.DEBUG==="true"&&console.log(`OpenAI:DEBUG:${e}`,...t)}let uuid4=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),isRunningInBrowser=()=>"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator;function isObj(e){return null!=e&&"object"==typeof e&&!Array.isArray(e)}let Page=class Page extends AbstractPage{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}};let CursorPage=class CursorPage extends AbstractPage{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){let e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;let t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){let e=this.getPaginatedItems();if(!e.length)return null;let t=e[e.length-1]?.id;return t?{params:{after:t}}:null}};let APIResource=class APIResource{constructor(e){this._client=e}};let Completions=class Completions extends APIResource{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}};Completions||(Completions={});let completions_Completions=class completions_Completions extends APIResource{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}};completions_Completions||(completions_Completions={});let Chat=class Chat extends APIResource{constructor(){super(...arguments),this.completions=new completions_Completions(this._client)}};(Chat||(Chat={})).Completions=completions_Completions;let Embeddings=class Embeddings extends APIResource{create(e,t){return this._client.post("/embeddings",{body:e,...t})}};Embeddings||(Embeddings={});let Files=class Files extends APIResource{create(e,t){return this._client.post("/files",multipartFormRequestOptions({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return isRequestOptions(e)?this.list({},e):this._client.getAPIList("/files",FileObjectsPage,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/json",...t?.headers}})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:r=18e5}={}){let s=new Set(["processed","error","deleted"]),n=Date.now(),i=await this.retrieve(e);for(;!i.status||!s.has(i.status);)if(await sleep(t),i=await this.retrieve(e),Date.now()-n>r)throw new APIConnectionTimeoutError({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return i}};let FileObjectsPage=class FileObjectsPage extends Page{};(Files||(Files={})).FileObjectsPage=FileObjectsPage;let Images=class Images extends APIResource{createVariation(e,t){return this._client.post("/images/variations",multipartFormRequestOptions({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",multipartFormRequestOptions({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}};Images||(Images={});let Speech=class Speech extends APIResource{create(e,t){return this._client.post("/audio/speech",{body:e,...t,__binaryResponse:!0})}};Speech||(Speech={});let Transcriptions=class Transcriptions extends APIResource{create(e,t){return this._client.post("/audio/transcriptions",multipartFormRequestOptions({body:e,...t}))}};Transcriptions||(Transcriptions={});let Translations=class Translations extends APIResource{create(e,t){return this._client.post("/audio/translations",multipartFormRequestOptions({body:e,...t}))}};Translations||(Translations={});let Audio=class Audio extends APIResource{constructor(){super(...arguments),this.transcriptions=new Transcriptions(this._client),this.translations=new Translations(this._client),this.speech=new Speech(this._client)}};(f=Audio||(Audio={})).Transcriptions=Transcriptions,f.Translations=Translations,f.Speech=Speech;let Moderations=class Moderations extends APIResource{create(e,t){return this._client.post("/moderations",{body:e,...t})}};Moderations||(Moderations={});let Models=class Models extends APIResource{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",ModelsPage,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}};let ModelsPage=class ModelsPage extends Page{};(Models||(Models={})).ModelsPage=ModelsPage;let Checkpoints=class Checkpoints extends APIResource{list(e,t={},r){return isRequestOptions(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,FineTuningJobCheckpointsPage,{query:t,...r})}};let FineTuningJobCheckpointsPage=class FineTuningJobCheckpointsPage extends CursorPage{};(Checkpoints||(Checkpoints={})).FineTuningJobCheckpointsPage=FineTuningJobCheckpointsPage;let Jobs=class Jobs extends APIResource{constructor(){super(...arguments),this.checkpoints=new Checkpoints(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return isRequestOptions(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",FineTuningJobsPage,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return isRequestOptions(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,FineTuningJobEventsPage,{query:t,...r})}};let FineTuningJobsPage=class FineTuningJobsPage extends CursorPage{};let FineTuningJobEventsPage=class FineTuningJobEventsPage extends CursorPage{};(p=Jobs||(Jobs={})).FineTuningJobsPage=FineTuningJobsPage,p.FineTuningJobEventsPage=FineTuningJobEventsPage,p.Checkpoints=Checkpoints,p.FineTuningJobCheckpointsPage=FineTuningJobCheckpointsPage;let FineTuning=class FineTuning extends APIResource{constructor(){super(...arguments),this.jobs=new Jobs(this._client)}};(m=FineTuning||(FineTuning={})).Jobs=Jobs,m.FineTuningJobsPage=FineTuningJobsPage,m.FineTuningJobEventsPage=FineTuningJobEventsPage;let Assistants=class Assistants extends APIResource{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,r){return this._client.post(`/assistants/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e={},t){return isRequestOptions(e)?this.list({},e):this._client.getAPIList("/assistants",AssistantsPage,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}};let AssistantsPage=class AssistantsPage extends CursorPage{};function isRunnableFunctionWithParse(e){return"function"==typeof e.parse}(Assistants||(Assistants={})).AssistantsPage=AssistantsPage;let isAssistantMessage=e=>e?.role==="assistant",isFunctionMessage=e=>e?.role==="function",isToolMessage=e=>e?.role==="tool";var AbstractChatCompletionRunner_classPrivateFieldSet=function(e,t,r,s,n){if("m"===s)throw TypeError("Private method is not writable");if("a"===s&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,r):n?n.value=r:t.set(e,r),r},AbstractChatCompletionRunner_classPrivateFieldGet=function(e,t,r,s){if("a"===r&&!s)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)};let AbstractChatCompletionRunner=class AbstractChatCompletionRunner{constructor(){v.add(this),this.controller=new AbortController,w.set(this,void 0),R.set(this,()=>{}),S.set(this,()=>{}),T.set(this,void 0),P.set(this,()=>{}),C.set(this,()=>{}),x.set(this,{}),this._chatCompletions=[],this.messages=[],I.set(this,!1),O.set(this,!1),F.set(this,!1),M.set(this,!1),j.set(this,e=>{if(AbstractChatCompletionRunner_classPrivateFieldSet(this,O,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new APIUserAbortError),e instanceof APIUserAbortError)return AbstractChatCompletionRunner_classPrivateFieldSet(this,F,!0,"f"),this._emit("abort",e);if(e instanceof error_OpenAIError)return this._emit("error",e);if(e instanceof Error){let t=new error_OpenAIError(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new error_OpenAIError(String(e)))}),AbstractChatCompletionRunner_classPrivateFieldSet(this,w,new Promise((e,t)=>{AbstractChatCompletionRunner_classPrivateFieldSet(this,R,e,"f"),AbstractChatCompletionRunner_classPrivateFieldSet(this,S,t,"f")}),"f"),AbstractChatCompletionRunner_classPrivateFieldSet(this,T,new Promise((e,t)=>{AbstractChatCompletionRunner_classPrivateFieldSet(this,P,e,"f"),AbstractChatCompletionRunner_classPrivateFieldSet(this,C,t,"f")}),"f"),AbstractChatCompletionRunner_classPrivateFieldGet(this,w,"f").catch(()=>{}),AbstractChatCompletionRunner_classPrivateFieldGet(this,T,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},AbstractChatCompletionRunner_classPrivateFieldGet(this,j,"f"))},0)}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);let t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(isFunctionMessage(e)||isToolMessage(e))&&e.content)this._emit("functionCallResult",e.content);else if(isAssistantMessage(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(isAssistantMessage(e)&&e.tool_calls)for(let t of e.tool_calls)"function"===t.type&&this._emit("functionCall",t.function)}}_connected(){this.ended||(AbstractChatCompletionRunner_classPrivateFieldGet(this,R,"f").call(this),this._emit("connect"))}get ended(){return AbstractChatCompletionRunner_classPrivateFieldGet(this,I,"f")}get errored(){return AbstractChatCompletionRunner_classPrivateFieldGet(this,O,"f")}get aborted(){return AbstractChatCompletionRunner_classPrivateFieldGet(this,F,"f")}abort(){this.controller.abort()}on(e,t){let r=AbstractChatCompletionRunner_classPrivateFieldGet(this,x,"f")[e]||(AbstractChatCompletionRunner_classPrivateFieldGet(this,x,"f")[e]=[]);return r.push({listener:t}),this}off(e,t){let r=AbstractChatCompletionRunner_classPrivateFieldGet(this,x,"f")[e];if(!r)return this;let s=r.findIndex(e=>e.listener===t);return s>=0&&r.splice(s,1),this}once(e,t){let r=AbstractChatCompletionRunner_classPrivateFieldGet(this,x,"f")[e]||(AbstractChatCompletionRunner_classPrivateFieldGet(this,x,"f")[e]=[]);return r.push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{AbstractChatCompletionRunner_classPrivateFieldSet(this,M,!0,"f"),"error"!==e&&this.once("error",r),this.once(e,t)})}async done(){AbstractChatCompletionRunner_classPrivateFieldSet(this,M,!0,"f"),await AbstractChatCompletionRunner_classPrivateFieldGet(this,T,"f")}async finalChatCompletion(){await this.done();let e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new error_OpenAIError("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),AbstractChatCompletionRunner_classPrivateFieldGet(this,v,"m",L).call(this)}async finalMessage(){return await this.done(),AbstractChatCompletionRunner_classPrivateFieldGet(this,v,"m",N).call(this)}async finalFunctionCall(){return await this.done(),AbstractChatCompletionRunner_classPrivateFieldGet(this,v,"m",k).call(this)}async finalFunctionCallResult(){return await this.done(),AbstractChatCompletionRunner_classPrivateFieldGet(this,v,"m",G).call(this)}async totalUsage(){return await this.done(),AbstractChatCompletionRunner_classPrivateFieldGet(this,v,"m",D).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emit(e,...t){if(AbstractChatCompletionRunner_classPrivateFieldGet(this,I,"f"))return;"end"===e&&(AbstractChatCompletionRunner_classPrivateFieldSet(this,I,!0,"f"),AbstractChatCompletionRunner_classPrivateFieldGet(this,P,"f").call(this));let r=AbstractChatCompletionRunner_classPrivateFieldGet(this,x,"f")[e];if(r&&(AbstractChatCompletionRunner_classPrivateFieldGet(this,x,"f")[e]=r.filter(e=>!e.once),r.forEach(({listener:e})=>e(...t))),"abort"===e){let e=t[0];AbstractChatCompletionRunner_classPrivateFieldGet(this,M,"f")||r?.length||Promise.reject(e),AbstractChatCompletionRunner_classPrivateFieldGet(this,S,"f").call(this,e),AbstractChatCompletionRunner_classPrivateFieldGet(this,C,"f").call(this,e),this._emit("end");return}if("error"===e){let e=t[0];AbstractChatCompletionRunner_classPrivateFieldGet(this,M,"f")||r?.length||Promise.reject(e),AbstractChatCompletionRunner_classPrivateFieldGet(this,S,"f").call(this,e),AbstractChatCompletionRunner_classPrivateFieldGet(this,C,"f").call(this,e),this._emit("end")}}_emitFinal(){let e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);let t=AbstractChatCompletionRunner_classPrivateFieldGet(this,v,"m",N).call(this);t&&this._emit("finalMessage",t);let r=AbstractChatCompletionRunner_classPrivateFieldGet(this,v,"m",L).call(this);r&&this._emit("finalContent",r);let s=AbstractChatCompletionRunner_classPrivateFieldGet(this,v,"m",k).call(this);s&&this._emit("finalFunctionCall",s);let n=AbstractChatCompletionRunner_classPrivateFieldGet(this,v,"m",G).call(this);null!=n&&this._emit("finalFunctionCallResult",n),this._chatCompletions.some(e=>e.usage)&&this._emit("totalUsage",AbstractChatCompletionRunner_classPrivateFieldGet(this,v,"m",D).call(this))}async _createChatCompletion(e,t,r){let s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),AbstractChatCompletionRunner_classPrivateFieldGet(this,v,"m",U).call(this,t);let n=await e.create({...t,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(n)}async _runChatCompletion(e,t,r){for(let e of t.messages)this._addMessage(e,!1);return await this._createChatCompletion(e,t,r)}async _runFunctions(e,t,r){let s="function",{function_call:n="auto",stream:i,...a}=t,o="string"!=typeof n&&n?.name,{maxChatCompletions:l=10}=r||{},c={};for(let e of t.functions)c[e.name||e.function.name]=e;let u=t.functions.map(e=>({name:e.name||e.function.name,parameters:e.parameters,description:e.description}));for(let e of t.messages)this._addMessage(e,!1);for(let t=0;t<l;++t){let t;let i=await this._createChatCompletion(e,{...a,function_call:n,functions:u,messages:[...this.messages]},r),l=i.choices[0]?.message;if(!l)throw new error_OpenAIError("missing message in ChatCompletion response");if(!l.function_call)return;let{name:d,arguments:h}=l.function_call,f=c[d];if(f){if(o&&o!==d){let e=`Invalid function_call: ${JSON.stringify(d)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:s,name:d,content:e});continue}}else{let e=`Invalid function_call: ${JSON.stringify(d)}. Available options are: ${u.map(e=>JSON.stringify(e.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:d,content:e});continue}try{t=isRunnableFunctionWithParse(f)?await f.parse(h):h}catch(e){this._addMessage({role:s,name:d,content:e instanceof Error?e.message:String(e)});continue}let p=await f.function(t,this),m=AbstractChatCompletionRunner_classPrivateFieldGet(this,v,"m",B).call(this,p);if(this._addMessage({role:s,name:d,content:m}),o)return}}async _runTools(e,t,r){let s="tool",{tool_choice:n="auto",stream:i,...a}=t,o="string"!=typeof n&&n?.function?.name,{maxChatCompletions:l=10}=r||{},c={};for(let e of t.tools)"function"===e.type&&(c[e.function.name||e.function.function.name]=e.function);let u="tools"in t?t.tools.map(e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description}}:e):void 0;for(let e of t.messages)this._addMessage(e,!1);for(let t=0;t<l;++t){let t=await this._createChatCompletion(e,{...a,tool_choice:n,tools:u,messages:[...this.messages]},r),i=t.choices[0]?.message;if(!i)throw new error_OpenAIError("missing message in ChatCompletion response");if(!i.tool_calls)break;for(let e of i.tool_calls){let t;if("function"!==e.type)continue;let r=e.id,{name:n,arguments:i}=e.function,a=c[n];if(a){if(o&&o!==n){let e=`Invalid tool_call: ${JSON.stringify(n)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:s,tool_call_id:r,content:e});continue}}else{let e=`Invalid tool_call: ${JSON.stringify(n)}. Available options are: ${u.map(e=>JSON.stringify(e.function.name)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:r,content:e});continue}try{t=isRunnableFunctionWithParse(a)?await a.parse(i):i}catch(t){let e=t instanceof Error?t.message:String(t);this._addMessage({role:s,tool_call_id:r,content:e});continue}let l=await a.function(t,this),d=AbstractChatCompletionRunner_classPrivateFieldGet(this,v,"m",B).call(this,l);if(this._addMessage({role:s,tool_call_id:r,content:d}),o)return}}}};w=new WeakMap,R=new WeakMap,S=new WeakMap,T=new WeakMap,P=new WeakMap,C=new WeakMap,x=new WeakMap,I=new WeakMap,O=new WeakMap,F=new WeakMap,M=new WeakMap,j=new WeakMap,v=new WeakSet,L=function(){return AbstractChatCompletionRunner_classPrivateFieldGet(this,v,"m",N).call(this).content??null},N=function(){let e=this.messages.length;for(;e-- >0;){let t=this.messages[e];if(isAssistantMessage(t)){let{function_call:e,...r}=t,s={...r,content:t.content??null};return e&&(s.function_call=e),s}}throw new error_OpenAIError("stream ended without producing a ChatCompletionMessage with role=assistant")},k=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(isAssistantMessage(t)&&t?.function_call)return t.function_call;if(isAssistantMessage(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},G=function(){for(let e=this.messages.length-1;e>=0;e--){let t=this.messages[e];if(isFunctionMessage(t)&&null!=t.content||isToolMessage(t)&&null!=t.content&&this.messages.some(e=>"assistant"===e.role&&e.tool_calls?.some(e=>"function"===e.type&&e.id===t.tool_call_id)))return t.content}},D=function(){let e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(let{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},U=function(e){if(null!=e.n&&e.n>1)throw new error_OpenAIError("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},B=function(e){return"string"==typeof e?e:void 0===e?"undefined":JSON.stringify(e)};let ChatCompletionRunner=class ChatCompletionRunner extends AbstractChatCompletionRunner{static runFunctions(e,t,r){let s=new ChatCompletionRunner,n={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,n)),s}static runTools(e,t,r){let s=new ChatCompletionRunner,n={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,n)),s}_addMessage(e){super._addMessage(e),isAssistantMessage(e)&&e.content&&this._emit("content",e.content)}};var ChatCompletionStream_classPrivateFieldGet=function(e,t,r,s){if("a"===r&&!s)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)},ChatCompletionStream_classPrivateFieldSet=function(e,t,r,s,n){if("m"===s)throw TypeError("Private method is not writable");if("a"===s&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,r):n?n.value=r:t.set(e,r),r};let ChatCompletionStream=class ChatCompletionStream extends AbstractChatCompletionRunner{constructor(){super(...arguments),H.add(this),q.set(this,void 0)}get currentChatCompletionSnapshot(){return ChatCompletionStream_classPrivateFieldGet(this,q,"f")}static fromReadableStream(e){let t=new ChatCompletionStream;return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,r){let s=new ChatCompletionStream;return s._run(()=>s._runChatCompletion(e,{...t,stream:!0},{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,t,r){let s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),ChatCompletionStream_classPrivateFieldGet(this,H,"m",$).call(this);let n=await e.create({...t,stream:!0},{...r,signal:this.controller.signal});for await(let e of(this._connected(),n))ChatCompletionStream_classPrivateFieldGet(this,H,"m",K).call(this,e);if(n.controller.signal?.aborted)throw new APIUserAbortError;return this._addChatCompletion(ChatCompletionStream_classPrivateFieldGet(this,H,"m",V).call(this))}async _fromReadableStream(e,t){let r;let s=t?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),ChatCompletionStream_classPrivateFieldGet(this,H,"m",$).call(this),this._connected();let n=Stream.fromReadableStream(e,this.controller);for await(let e of n)r&&r!==e.id&&this._addChatCompletion(ChatCompletionStream_classPrivateFieldGet(this,H,"m",V).call(this)),ChatCompletionStream_classPrivateFieldGet(this,H,"m",K).call(this,e),r=e.id;if(n.controller.signal?.aborted)throw new APIUserAbortError;return this._addChatCompletion(ChatCompletionStream_classPrivateFieldGet(this,H,"m",V).call(this))}[(q=new WeakMap,H=new WeakSet,$=function(){this.ended||ChatCompletionStream_classPrivateFieldSet(this,q,void 0,"f")},K=function(e){if(this.ended)return;let t=ChatCompletionStream_classPrivateFieldGet(this,H,"m",z).call(this,e);this._emit("chunk",e,t);let r=e.choices[0]?.delta?.content,s=t.choices[0]?.message;null!=r&&s?.role==="assistant"&&s?.content&&this._emit("content",r,s.content)},V=function(){if(this.ended)throw new error_OpenAIError("stream has ended, this shouldn't happen");let e=ChatCompletionStream_classPrivateFieldGet(this,q,"f");if(!e)throw new error_OpenAIError("request ended without sending any chunks");return ChatCompletionStream_classPrivateFieldSet(this,q,void 0,"f"),function(e){let{id:t,choices:r,created:s,model:n,system_fingerprint:i,...a}=e;return{...a,id:t,choices:r.map(({message:t,finish_reason:r,index:s,logprobs:n,...i})=>{if(!r)throw new error_OpenAIError(`missing finish_reason for choice ${s}`);let{content:a=null,function_call:o,tool_calls:l,...c}=t,u=t.role;if(!u)throw new error_OpenAIError(`missing role for choice ${s}`);if(o){let{arguments:e,name:t}=o;if(null==e)throw new error_OpenAIError(`missing function_call.arguments for choice ${s}`);if(!t)throw new error_OpenAIError(`missing function_call.name for choice ${s}`);return{...i,message:{content:a,function_call:{arguments:e,name:t},role:u},finish_reason:r,index:s,logprobs:n}}return l?{...i,index:s,finish_reason:r,logprobs:n,message:{...c,role:u,content:a,tool_calls:l.map((t,r)=>{let{function:n,type:i,id:a,...o}=t,{arguments:l,name:c,...u}=n||{};if(null==a)throw new error_OpenAIError(`missing choices[${s}].tool_calls[${r}].id
${str(e)}`);if(null==i)throw new error_OpenAIError(`missing choices[${s}].tool_calls[${r}].type
${str(e)}`);if(null==c)throw new error_OpenAIError(`missing choices[${s}].tool_calls[${r}].function.name
${str(e)}`);if(null==l)throw new error_OpenAIError(`missing choices[${s}].tool_calls[${r}].function.arguments
${str(e)}`);return{...o,id:a,type:i,function:{...u,name:c,arguments:l}}})}}:{...i,message:{...c,content:a,role:u},finish_reason:r,index:s,logprobs:n}}),created:s,model:n,object:"chat.completion",...i?{system_fingerprint:i}:{}}}(e)},z=function(e){var t,r,s;let n=ChatCompletionStream_classPrivateFieldGet(this,q,"f"),{choices:i,...a}=e;for(let{delta:i,finish_reason:o,index:l,logprobs:c=null,...u}of(n?Object.assign(n,a):n=ChatCompletionStream_classPrivateFieldSet(this,q,{...a,choices:[]},"f"),e.choices)){let e=n.choices[l];if(e||(e=n.choices[l]={finish_reason:o,index:l,message:{},logprobs:c,...u}),c){if(e.logprobs){let{content:r,...s}=c;Object.assign(e.logprobs,s),r&&((t=e.logprobs).content??(t.content=[]),e.logprobs.content.push(...r))}else e.logprobs=Object.assign({},c)}if(o&&(e.finish_reason=o),Object.assign(e,u),!i)continue;let{content:a,function_call:d,role:h,tool_calls:f,...p}=i;if(Object.assign(e.message,p),a&&(e.message.content=(e.message.content||"")+a),h&&(e.message.role=h),d&&(e.message.function_call?(d.name&&(e.message.function_call.name=d.name),d.arguments&&((r=e.message.function_call).arguments??(r.arguments=""),e.message.function_call.arguments+=d.arguments)):e.message.function_call=d),f)for(let{index:t,id:r,type:n,function:i,...a}of(e.message.tool_calls||(e.message.tool_calls=[]),f)){let o=(s=e.message.tool_calls)[t]??(s[t]={});Object.assign(o,a),r&&(o.id=r),n&&(o.type=n),i&&(o.function??(o.function={arguments:""})),i?.name&&(o.function.name=i.name),i?.arguments&&(o.function.arguments+=i.arguments)}}return n},Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("chunk",r=>{let s=t.shift();s?s.resolve(r):e.push(r)}),this.on("end",()=>{for(let e of(r=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let s of(r=!0,t))s.reject(e);t.length=0}),this.on("error",e=>{for(let s of(r=!0,t))s.reject(e);t.length=0}),{next:async()=>{if(!e.length)return r?{value:void 0,done:!0}:new Promise((e,r)=>t.push({resolve:e,reject:r})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0});let s=e.shift();return{value:s,done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){let e=new Stream(this[Symbol.asyncIterator].bind(this),this.controller);return e.toReadableStream()}};function str(e){return JSON.stringify(e)}let ChatCompletionStreamingRunner=class ChatCompletionStreamingRunner extends ChatCompletionStream{static fromReadableStream(e){let t=new ChatCompletionStreamingRunner;return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,r){let s=new ChatCompletionStreamingRunner,n={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,n)),s}static runTools(e,t,r){let s=new ChatCompletionStreamingRunner,n={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,n)),s}};let chat_completions_Completions=class chat_completions_Completions extends APIResource{runFunctions(e,t){return e.stream?ChatCompletionStreamingRunner.runFunctions(this._client.chat.completions,e,t):ChatCompletionRunner.runFunctions(this._client.chat.completions,e,t)}runTools(e,t){return e.stream?ChatCompletionStreamingRunner.runTools(this._client.chat.completions,e,t):ChatCompletionRunner.runTools(this._client.chat.completions,e,t)}stream(e,t){return ChatCompletionStream.createChatCompletion(this._client.chat.completions,e,t)}};let chat_Chat=class chat_Chat extends APIResource{constructor(){super(...arguments),this.completions=new chat_completions_Completions(this._client)}};(chat_Chat||(chat_Chat={})).Completions=chat_completions_Completions;var AbstractAssistantStreamRunner_classPrivateFieldSet=function(e,t,r,s,n){if("m"===s)throw TypeError("Private method is not writable");if("a"===s&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,r):n?n.value=r:t.set(e,r),r},AbstractAssistantStreamRunner_classPrivateFieldGet=function(e,t,r,s){if("a"===r&&!s)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)};let AbstractAssistantStreamRunner=class AbstractAssistantStreamRunner{constructor(){this.controller=new AbortController,W.set(this,void 0),X.set(this,()=>{}),J.set(this,()=>{}),Y.set(this,void 0),Z.set(this,()=>{}),Q.set(this,()=>{}),ee.set(this,{}),et.set(this,!1),er.set(this,!1),es.set(this,!1),en.set(this,!1),ei.set(this,e=>{if(AbstractAssistantStreamRunner_classPrivateFieldSet(this,er,!0,"f"),e instanceof Error&&"AbortError"===e.name&&(e=new APIUserAbortError),e instanceof APIUserAbortError)return AbstractAssistantStreamRunner_classPrivateFieldSet(this,es,!0,"f"),this._emit("abort",e);if(e instanceof error_OpenAIError)return this._emit("error",e);if(e instanceof Error){let t=new error_OpenAIError(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new error_OpenAIError(String(e)))}),AbstractAssistantStreamRunner_classPrivateFieldSet(this,W,new Promise((e,t)=>{AbstractAssistantStreamRunner_classPrivateFieldSet(this,X,e,"f"),AbstractAssistantStreamRunner_classPrivateFieldSet(this,J,t,"f")}),"f"),AbstractAssistantStreamRunner_classPrivateFieldSet(this,Y,new Promise((e,t)=>{AbstractAssistantStreamRunner_classPrivateFieldSet(this,Z,e,"f"),AbstractAssistantStreamRunner_classPrivateFieldSet(this,Q,t,"f")}),"f"),AbstractAssistantStreamRunner_classPrivateFieldGet(this,W,"f").catch(()=>{}),AbstractAssistantStreamRunner_classPrivateFieldGet(this,Y,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emit("end")},AbstractAssistantStreamRunner_classPrivateFieldGet(this,ei,"f"))},0)}_addRun(e){return e}_connected(){this.ended||(AbstractAssistantStreamRunner_classPrivateFieldGet(this,X,"f").call(this),this._emit("connect"))}get ended(){return AbstractAssistantStreamRunner_classPrivateFieldGet(this,et,"f")}get errored(){return AbstractAssistantStreamRunner_classPrivateFieldGet(this,er,"f")}get aborted(){return AbstractAssistantStreamRunner_classPrivateFieldGet(this,es,"f")}abort(){this.controller.abort()}on(e,t){let r=AbstractAssistantStreamRunner_classPrivateFieldGet(this,ee,"f")[e]||(AbstractAssistantStreamRunner_classPrivateFieldGet(this,ee,"f")[e]=[]);return r.push({listener:t}),this}off(e,t){let r=AbstractAssistantStreamRunner_classPrivateFieldGet(this,ee,"f")[e];if(!r)return this;let s=r.findIndex(e=>e.listener===t);return s>=0&&r.splice(s,1),this}once(e,t){let r=AbstractAssistantStreamRunner_classPrivateFieldGet(this,ee,"f")[e]||(AbstractAssistantStreamRunner_classPrivateFieldGet(this,ee,"f")[e]=[]);return r.push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{AbstractAssistantStreamRunner_classPrivateFieldSet(this,en,!0,"f"),"error"!==e&&this.once("error",r),this.once(e,t)})}async done(){AbstractAssistantStreamRunner_classPrivateFieldSet(this,en,!0,"f"),await AbstractAssistantStreamRunner_classPrivateFieldGet(this,Y,"f")}_emit(e,...t){if(AbstractAssistantStreamRunner_classPrivateFieldGet(this,et,"f"))return;"end"===e&&(AbstractAssistantStreamRunner_classPrivateFieldSet(this,et,!0,"f"),AbstractAssistantStreamRunner_classPrivateFieldGet(this,Z,"f").call(this));let r=AbstractAssistantStreamRunner_classPrivateFieldGet(this,ee,"f")[e];if(r&&(AbstractAssistantStreamRunner_classPrivateFieldGet(this,ee,"f")[e]=r.filter(e=>!e.once),r.forEach(({listener:e})=>e(...t))),"abort"===e){let e=t[0];AbstractAssistantStreamRunner_classPrivateFieldGet(this,en,"f")||r?.length||Promise.reject(e),AbstractAssistantStreamRunner_classPrivateFieldGet(this,J,"f").call(this,e),AbstractAssistantStreamRunner_classPrivateFieldGet(this,Q,"f").call(this,e),this._emit("end");return}if("error"===e){let e=t[0];AbstractAssistantStreamRunner_classPrivateFieldGet(this,en,"f")||r?.length||Promise.reject(e),AbstractAssistantStreamRunner_classPrivateFieldGet(this,J,"f").call(this,e),AbstractAssistantStreamRunner_classPrivateFieldGet(this,Q,"f").call(this,e),this._emit("end")}}async _threadAssistantStream(e,t,r){return await this._createThreadAssistantStream(t,e,r)}async _runAssistantStream(e,t,r,s){return await this._createAssistantStream(t,e,r,s)}async _runToolAssistantStream(e,t,r,s,n){return await this._createToolAssistantStream(r,e,t,s,n)}async _createThreadAssistantStream(e,t,r){let s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));let n=await e.createAndRun({...t,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addRun(n)}async _createToolAssistantStream(e,t,r,s,n){let i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));let a=await e.submitToolOutputs(t,r,{...s,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addRun(a)}async _createAssistantStream(e,t,r,s){let n=s?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort()));let i=await e.create(t,{...r,stream:!1},{...s,signal:this.controller.signal});return this._connected(),this._addRun(i)}};W=new WeakMap,X=new WeakMap,J=new WeakMap,Y=new WeakMap,Z=new WeakMap,Q=new WeakMap,ee=new WeakMap,et=new WeakMap,er=new WeakMap,es=new WeakMap,en=new WeakMap,ei=new WeakMap;var AssistantStream_classPrivateFieldGet=function(e,t,r,s){if("a"===r&&!s)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?s:"a"===r?s.call(e):s?s.value:t.get(e)},AssistantStream_classPrivateFieldSet=function(e,t,r,s,n){if("m"===s)throw TypeError("Private method is not writable");if("a"===s&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?n.call(e,r):n?n.value=r:t.set(e,r),r};let AssistantStream=class AssistantStream extends AbstractAssistantStreamRunner{constructor(){super(...arguments),ea.add(this),eo.set(this,[]),el.set(this,{}),ec.set(this,{}),eu.set(this,void 0),ed.set(this,void 0),eh.set(this,void 0),ef.set(this,void 0),ep.set(this,void 0),em.set(this,void 0),eg.set(this,void 0),eA.set(this,void 0),eb.set(this,void 0)}[(eo=new WeakMap,el=new WeakMap,ec=new WeakMap,eu=new WeakMap,ed=new WeakMap,eh=new WeakMap,ef=new WeakMap,ep=new WeakMap,em=new WeakMap,eg=new WeakMap,eA=new WeakMap,eb=new WeakMap,ea=new WeakSet,Symbol.asyncIterator)](){let e=[],t=[],r=!1;return this.on("event",r=>{let s=t.shift();s?s.resolve(r):e.push(r)}),this.on("end",()=>{for(let e of(r=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let s of(r=!0,t))s.reject(e);t.length=0}),this.on("error",e=>{for(let s of(r=!0,t))s.reject(e);t.length=0}),{next:async()=>{if(!e.length)return r?{value:void 0,done:!0}:new Promise((e,r)=>t.push({resolve:e,reject:r})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0});let s=e.shift();return{value:s,done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){let t=new AssistantStream;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){let r=t?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();let s=Stream.fromReadableStream(e,this.controller);for await(let e of s)AssistantStream_classPrivateFieldGet(this,ea,"m",ey).call(this,e);if(s.controller.signal?.aborted)throw new APIUserAbortError;return this._addRun(AssistantStream_classPrivateFieldGet(this,ea,"m",eE).call(this))}toReadableStream(){let e=new Stream(this[Symbol.asyncIterator].bind(this),this.controller);return e.toReadableStream()}static createToolAssistantStream(e,t,r,s,n){let i=new AssistantStream;return i._run(()=>i._runToolAssistantStream(e,t,r,s,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),i}async _createToolAssistantStream(e,t,r,s,n){let i=n?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));let a={...s,stream:!0},o=await e.submitToolOutputs(t,r,a,{...n,signal:this.controller.signal});for await(let e of(this._connected(),o))AssistantStream_classPrivateFieldGet(this,ea,"m",ey).call(this,e);if(o.controller.signal?.aborted)throw new APIUserAbortError;return this._addRun(AssistantStream_classPrivateFieldGet(this,ea,"m",eE).call(this))}static createThreadAssistantStream(e,t,r){let s=new AssistantStream;return s._run(()=>s._threadAssistantStream(e,t,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,t,r,s){let n=new AssistantStream;return n._run(()=>n._runAssistantStream(e,t,r,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),n}currentEvent(){return AssistantStream_classPrivateFieldGet(this,eg,"f")}currentRun(){return AssistantStream_classPrivateFieldGet(this,eA,"f")}currentMessageSnapshot(){return AssistantStream_classPrivateFieldGet(this,eu,"f")}currentRunStepSnapshot(){return AssistantStream_classPrivateFieldGet(this,eb,"f")}async finalRunSteps(){return await this.done(),Object.values(AssistantStream_classPrivateFieldGet(this,el,"f"))}async finalMessages(){return await this.done(),Object.values(AssistantStream_classPrivateFieldGet(this,ec,"f"))}async finalRun(){if(await this.done(),!AssistantStream_classPrivateFieldGet(this,ed,"f"))throw Error("Final run was not received.");return AssistantStream_classPrivateFieldGet(this,ed,"f")}async _createThreadAssistantStream(e,t,r){let s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));let n={...t,stream:!0},i=await e.createAndRun(n,{...r,signal:this.controller.signal});for await(let e of(this._connected(),i))AssistantStream_classPrivateFieldGet(this,ea,"m",ey).call(this,e);if(i.controller.signal?.aborted)throw new APIUserAbortError;return this._addRun(AssistantStream_classPrivateFieldGet(this,ea,"m",eE).call(this))}async _createAssistantStream(e,t,r,s){let n=s?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort()));let i={...r,stream:!0},a=await e.create(t,i,{...s,signal:this.controller.signal});for await(let e of(this._connected(),a))AssistantStream_classPrivateFieldGet(this,ea,"m",ey).call(this,e);if(a.controller.signal?.aborted)throw new APIUserAbortError;return this._addRun(AssistantStream_classPrivateFieldGet(this,ea,"m",eE).call(this))}static accumulateDelta(e,t){for(let[r,s]of Object.entries(t)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let t=e[r];if(null==t||"index"===r||"type"===r){e[r]=s;continue}if("string"==typeof t&&"string"==typeof s)t+=s;else if("number"==typeof t&&"number"==typeof s)t+=s;else if(isObj(t)&&isObj(s))t=this.accumulateDelta(t,s);else if(Array.isArray(t)&&Array.isArray(s)){if(t.every(e=>"string"==typeof e||"number"==typeof e)){t.push(...s);continue}}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${t}`);e[r]=t}return e}};ey=function(e){if(!this.ended)switch(AssistantStream_classPrivateFieldSet(this,eg,e,"f"),AssistantStream_classPrivateFieldGet(this,ea,"m",ew).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":AssistantStream_classPrivateFieldGet(this,ea,"m",eP).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":AssistantStream_classPrivateFieldGet(this,ea,"m",ev).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":AssistantStream_classPrivateFieldGet(this,ea,"m",e_).call(this,e);break;case"error":throw Error("Encountered an error event in event processing - errors should be processed earlier")}},eE=function(){if(this.ended)throw new error_OpenAIError("stream has ended, this shouldn't happen");if(!AssistantStream_classPrivateFieldGet(this,ed,"f"))throw Error("Final run has not been received");return AssistantStream_classPrivateFieldGet(this,ed,"f")},e_=function(e){let[t,r]=AssistantStream_classPrivateFieldGet(this,ea,"m",eS).call(this,e,AssistantStream_classPrivateFieldGet(this,eu,"f"));for(let e of(AssistantStream_classPrivateFieldSet(this,eu,t,"f"),AssistantStream_classPrivateFieldGet(this,ec,"f")[t.id]=t,r)){let r=t.content[e.index];r?.type=="text"&&this._emit("textCreated",r.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(let r of e.data.delta.content){if("text"==r.type&&r.text){let e=r.text,s=t.content[r.index];if(s&&"text"==s.type)this._emit("textDelta",e,s.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(r.index!=AssistantStream_classPrivateFieldGet(this,eh,"f")){if(AssistantStream_classPrivateFieldGet(this,ef,"f"))switch(AssistantStream_classPrivateFieldGet(this,ef,"f").type){case"text":this._emit("textDone",AssistantStream_classPrivateFieldGet(this,ef,"f").text,AssistantStream_classPrivateFieldGet(this,eu,"f"));break;case"image_file":this._emit("imageFileDone",AssistantStream_classPrivateFieldGet(this,ef,"f").image_file,AssistantStream_classPrivateFieldGet(this,eu,"f"))}AssistantStream_classPrivateFieldSet(this,eh,r.index,"f")}AssistantStream_classPrivateFieldSet(this,ef,t.content[r.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==AssistantStream_classPrivateFieldGet(this,eh,"f")){let t=e.data.content[AssistantStream_classPrivateFieldGet(this,eh,"f")];if(t)switch(t.type){case"image_file":this._emit("imageFileDone",t.image_file,AssistantStream_classPrivateFieldGet(this,eu,"f"));break;case"text":this._emit("textDone",t.text,AssistantStream_classPrivateFieldGet(this,eu,"f"))}}AssistantStream_classPrivateFieldGet(this,eu,"f")&&this._emit("messageDone",e.data),AssistantStream_classPrivateFieldSet(this,eu,void 0,"f")}},ev=function(e){let t=AssistantStream_classPrivateFieldGet(this,ea,"m",eR).call(this,e);switch(AssistantStream_classPrivateFieldSet(this,eb,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":let r=e.data.delta;if(r.step_details&&"tool_calls"==r.step_details.type&&r.step_details.tool_calls&&"tool_calls"==t.step_details.type)for(let e of r.step_details.tool_calls)e.index==AssistantStream_classPrivateFieldGet(this,ep,"f")?this._emit("toolCallDelta",e,t.step_details.tool_calls[e.index]):(AssistantStream_classPrivateFieldGet(this,em,"f")&&this._emit("toolCallDone",AssistantStream_classPrivateFieldGet(this,em,"f")),AssistantStream_classPrivateFieldSet(this,ep,e.index,"f"),AssistantStream_classPrivateFieldSet(this,em,t.step_details.tool_calls[e.index],"f"),AssistantStream_classPrivateFieldGet(this,em,"f")&&this._emit("toolCallCreated",AssistantStream_classPrivateFieldGet(this,em,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":AssistantStream_classPrivateFieldSet(this,eb,void 0,"f");let s=e.data.step_details;"tool_calls"==s.type&&AssistantStream_classPrivateFieldGet(this,em,"f")&&(this._emit("toolCallDone",AssistantStream_classPrivateFieldGet(this,em,"f")),AssistantStream_classPrivateFieldSet(this,em,void 0,"f")),this._emit("runStepDone",e.data,t)}},ew=function(e){AssistantStream_classPrivateFieldGet(this,eo,"f").push(e),this._emit("event",e)},eR=function(e){switch(e.event){case"thread.run.step.created":return AssistantStream_classPrivateFieldGet(this,el,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=AssistantStream_classPrivateFieldGet(this,el,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){let s=AssistantStream.accumulateDelta(t,r.delta);AssistantStream_classPrivateFieldGet(this,el,"f")[e.data.id]=s}return AssistantStream_classPrivateFieldGet(this,el,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":AssistantStream_classPrivateFieldGet(this,el,"f")[e.data.id]=e.data}if(AssistantStream_classPrivateFieldGet(this,el,"f")[e.data.id])return AssistantStream_classPrivateFieldGet(this,el,"f")[e.data.id];throw Error("No snapshot available")},eS=function(e,t){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(let e of s.delta.content)if(e.index in t.content){let r=t.content[e.index];t.content[e.index]=AssistantStream_classPrivateFieldGet(this,ea,"m",eT).call(this,e,r)}else t.content[e.index]=e,r.push(e);return[t,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},eT=function(e,t){return AssistantStream.accumulateDelta(t,e)},eP=function(e){switch(AssistantStream_classPrivateFieldSet(this,eA,e.data,"f"),e.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":AssistantStream_classPrivateFieldSet(this,ed,e.data,"f"),AssistantStream_classPrivateFieldGet(this,em,"f")&&(this._emit("toolCallDone",AssistantStream_classPrivateFieldGet(this,em,"f")),AssistantStream_classPrivateFieldSet(this,em,void 0,"f"))}};let Messages=class Messages extends APIResource{create(e,t,r){return this._client.post(`/threads/${e}/messages`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(e,t,r){return this._client.get(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}update(e,t,r,s){return this._client.post(`/threads/${e}/messages/${t}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e,t={},r){return isRequestOptions(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,MessagesPage,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(e,t,r){return this._client.delete(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}};let MessagesPage=class MessagesPage extends CursorPage{};(Messages||(Messages={})).MessagesPage=MessagesPage;let Steps=class Steps extends APIResource{retrieve(e,t,r,s){return this._client.get(`/threads/${e}/runs/${t}/steps/${r}`,{...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e,t,r={},s){return isRequestOptions(r)?this.list(e,t,{},r):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,RunStepsPage,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}};let RunStepsPage=class RunStepsPage extends CursorPage{};(Steps||(Steps={})).RunStepsPage=RunStepsPage;let Runs=class Runs extends APIResource{constructor(){super(...arguments),this.steps=new Steps(this._client)}create(e,t,r){return this._client.post(`/threads/${e}/runs`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers},stream:t.stream??!1})}retrieve(e,t,r){return this._client.get(`/threads/${e}/runs/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}update(e,t,r,s){return this._client.post(`/threads/${e}/runs/${t}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e,t={},r){return isRequestOptions(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,RunsPage,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}cancel(e,t,r){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async createAndPoll(e,t,r){let s=await this.create(e,t,r);return await this.poll(e,s.id,r)}createAndStream(e,t,r){return AssistantStream.createAssistantStream(e,this._client.beta.threads.runs,t,r)}async poll(e,t,r){let s={...r?.headers,"X-Stainless-Poll-Helper":"true"};for(r?.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){let{data:n,response:i}=await this.retrieve(e,t,{...r,headers:{...r?.headers,...s}}).withResponse();switch(n.status){case"queued":case"in_progress":case"cancelling":let a=5e3;if(r?.pollIntervalMs)a=r.pollIntervalMs;else{let e=i.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(a=t)}}await sleep(a);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return n}}}stream(e,t,r){return AssistantStream.createAssistantStream(e,this._client.beta.threads.runs,t,r)}submitToolOutputs(e,t,r,s){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,t,r,s){let n=await this.submitToolOutputs(e,t,r,s);return await this.poll(e,n.id,s)}submitToolOutputsStream(e,t,r,s){return AssistantStream.createToolAssistantStream(e,t,this._client.beta.threads.runs,r,s)}};let RunsPage=class RunsPage extends CursorPage{};(g=Runs||(Runs={})).RunsPage=RunsPage,g.Steps=Steps,g.RunStepsPage=RunStepsPage;let Threads=class Threads extends APIResource{constructor(){super(...arguments),this.runs=new Runs(this._client),this.messages=new Messages(this._client)}create(e={},t){return isRequestOptions(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,r){return this._client.post(`/threads/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){let r=await this.createAndRun(e,t);return await this.runs.poll(r.thread_id,r.id,t)}createAndRunStream(e,t){return AssistantStream.createThreadAssistantStream(e,this._client.beta.threads,t)}};(A=Threads||(Threads={})).Runs=Runs,A.RunsPage=RunsPage,A.Messages=Messages,A.MessagesPage=MessagesPage;let allSettledWithThrow=async e=>{let t=await Promise.allSettled(e),r=t.filter(e=>"rejected"===e.status);if(r.length){for(let e of r)console.error(e.reason);throw Error(`${r.length} promise(s) failed - see the above errors`)}let s=[];for(let e of t)"fulfilled"===e.status&&s.push(e.value);return s};let files_Files=class files_Files extends APIResource{create(e,t,r){return this._client.post(`/vector_stores/${e}/files`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,t={},r){return isRequestOptions(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,VectorStoreFilesPage,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(e,t,r){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async createAndPoll(e,t,r){let s=await this.create(e,t,r);return await this.poll(e,s.id,r)}async poll(e,t,r){let s={...r?.headers,"X-Stainless-Poll-Helper":"true"};for(r?.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){let n=await this.retrieve(e,t,{...r,headers:s}).withResponse(),i=n.data;switch(i.status){case"in_progress":let a=5e3;if(r?.pollIntervalMs)a=r.pollIntervalMs;else{let e=n.response.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(a=t)}}await sleep(a);break;case"failed":case"completed":return i}}}async upload(e,t,r){let s=await this._client.files.create({file:t,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,t,r){let s=await this.upload(e,t,r);return await this.poll(e,s.id,r)}};let VectorStoreFilesPage=class VectorStoreFilesPage extends CursorPage{};(files_Files||(files_Files={})).VectorStoreFilesPage=VectorStoreFilesPage;let FileBatches=class FileBatches extends APIResource{create(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}cancel(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async createAndPoll(e,t,r){let s=await this.create(e,t);return await this.poll(e,s.id,r)}listFiles(e,t,r={},s){return isRequestOptions(r)?this.listFiles(e,t,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,VectorStoreFilesPage,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}async poll(e,t,r){let s={...r?.headers,"X-Stainless-Poll-Helper":"true"};for(r?.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){let{data:n,response:i}=await this.retrieve(e,t,{...r,headers:s}).withResponse();switch(n.status){case"in_progress":let a=5e3;if(r?.pollIntervalMs)a=r.pollIntervalMs;else{let e=i.headers.get("openai-poll-after-ms");if(e){let t=parseInt(e);isNaN(t)||(a=t)}}await sleep(a);break;case"failed":case"cancelled":case"completed":return n}}}async uploadAndPoll(e,{files:t,fileIds:r=[]},s){if(null===t||0==t.length)throw Error("No files provided to process.");let n=s?.maxConcurrency??5,i=Math.min(n,t.length),a=this._client,o=t.values(),l=[...r];async function processFiles(e){for(let t of e){let e=await a.files.create({file:t,purpose:"assistants"},s);l.push(e.id)}}let c=Array(i).fill(o).map(processFiles);return await allSettledWithThrow(c),await this.createAndPoll(e,{file_ids:l})}};FileBatches||(FileBatches={});let VectorStores=class VectorStores extends APIResource{constructor(){super(...arguments),this.files=new files_Files(this._client),this.fileBatches=new FileBatches(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}update(e,t,r){return this._client.post(`/vector_stores/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e={},t){return isRequestOptions(e)?this.list({},e):this._client.getAPIList("/vector_stores",VectorStoresPage,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t?.headers}})}};let VectorStoresPage=class VectorStoresPage extends CursorPage{};(b=VectorStores||(VectorStores={})).VectorStoresPage=VectorStoresPage,b.Files=files_Files,b.VectorStoreFilesPage=VectorStoreFilesPage,b.FileBatches=FileBatches;let Beta=class Beta extends APIResource{constructor(){super(...arguments),this.vectorStores=new VectorStores(this._client),this.chat=new chat_Chat(this._client),this.assistants=new Assistants(this._client),this.threads=new Threads(this._client)}};(y=Beta||(Beta={})).VectorStores=VectorStores,y.VectorStoresPage=VectorStoresPage,y.Chat=chat_Chat,y.Assistants=Assistants,y.AssistantsPage=AssistantsPage,y.Threads=Threads;let Batches=class Batches extends APIResource{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return isRequestOptions(e)?this.list({},e):this._client.getAPIList("/batches",BatchesPage,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}};let BatchesPage=class BatchesPage extends CursorPage{};(Batches||(Batches={})).BatchesPage=BatchesPage,r(3454);let OpenAI=class OpenAI extends APIClient{constructor({baseURL:e=readEnv("OPENAI_BASE_URL"),apiKey:t=readEnv("OPENAI_API_KEY"),organization:r=readEnv("OPENAI_ORG_ID")??null,project:s=readEnv("OPENAI_PROJECT_ID")??null,...n}={}){if(void 0===t)throw new error_OpenAIError("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");let i={apiKey:t,organization:r,project:s,...n,baseURL:e||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&isRunningInBrowser())throw new error_OpenAIError("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:i.baseURL,timeout:i.timeout??6e5,httpAgent:i.httpAgent,maxRetries:i.maxRetries,fetch:i.fetch}),this.completions=new Completions(this),this.chat=new Chat(this),this.embeddings=new Embeddings(this),this.files=new Files(this),this.images=new Images(this),this.audio=new Audio(this),this.moderations=new Moderations(this),this.models=new Models(this),this.fineTuning=new FineTuning(this),this.beta=new Beta(this),this.batches=new Batches(this),this._options=i,this.apiKey=t,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}};eC=OpenAI,OpenAI.OpenAI=eC,OpenAI.OpenAIError=error_OpenAIError,OpenAI.APIError=APIError,OpenAI.APIConnectionError=APIConnectionError,OpenAI.APIConnectionTimeoutError=APIConnectionTimeoutError,OpenAI.APIUserAbortError=APIUserAbortError,OpenAI.NotFoundError=NotFoundError,OpenAI.ConflictError=ConflictError,OpenAI.RateLimitError=RateLimitError,OpenAI.BadRequestError=BadRequestError,OpenAI.AuthenticationError=AuthenticationError,OpenAI.InternalServerError=InternalServerError,OpenAI.PermissionDeniedError=PermissionDeniedError,OpenAI.UnprocessableEntityError=UnprocessableEntityError,OpenAI.toFile=toFile,OpenAI.fileFromPath=d;let{OpenAIError:eD,APIError:ej,APIConnectionError:eU,APIConnectionTimeoutError:eB,APIUserAbortError:eH,NotFoundError:eq,ConflictError:e$,RateLimitError:eK,BadRequestError:eV,AuthenticationError:ez,InternalServerError:eW,PermissionDeniedError:eX,UnprocessableEntityError:eJ}=ex;(E=OpenAI||(OpenAI={})).Page=Page,E.CursorPage=CursorPage,E.Completions=Completions,E.Chat=Chat,E.Embeddings=Embeddings,E.Files=Files,E.FileObjectsPage=FileObjectsPage,E.Images=Images,E.Audio=Audio,E.Moderations=Moderations,E.Models=Models,E.ModelsPage=ModelsPage,E.FineTuning=FineTuning,E.Beta=Beta,E.Batches=Batches,E.BatchesPage=BatchesPage},9365:function(e,t,r){"use strict";r.d(t,{z:function(){return OrbitControls}});var s=r(9477);let n={type:"change"},i={type:"start"},a={type:"end"},o=new s.zHn,l=new s.JOQ,c=Math.cos(70*s.M8C.DEG2RAD);let OrbitControls=class OrbitControls extends s.pBf{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new s.Pa4,this.cursor=new s.Pa4,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:s.RsA.ROTATE,MIDDLE:s.RsA.DOLLY,RIGHT:s.RsA.PAN},this.touches={ONE:s.QmN.ROTATE,TWO:s.QmN.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return f.phi},this.getAzimuthalAngle=function(){return f.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(e){e.addEventListener("keydown",onKeyDown),this._domElementKeyEvents=e},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",onKeyDown),this._domElementKeyEvents=null},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(n),r.update(),d=u.NONE},this.update=function(){let t=new s.Pa4,i=new s._fP().setFromUnitVectors(e.up,new s.Pa4(0,1,0)),a=i.clone().invert(),A=new s.Pa4,b=new s._fP,y=new s.Pa4,E=2*Math.PI;return function(_=null){let v=r.object.position;t.copy(v).sub(r.target),t.applyQuaternion(i),f.setFromVector3(t),r.autoRotate&&d===u.NONE&&rotateLeft(null!==_?2*Math.PI/60*r.autoRotateSpeed*_:2*Math.PI/60/60*r.autoRotateSpeed),r.enableDamping?(f.theta+=p.theta*r.dampingFactor,f.phi+=p.phi*r.dampingFactor):(f.theta+=p.theta,f.phi+=p.phi);let w=r.minAzimuthAngle,R=r.maxAzimuthAngle;isFinite(w)&&isFinite(R)&&(w<-Math.PI?w+=E:w>Math.PI&&(w-=E),R<-Math.PI?R+=E:R>Math.PI&&(R-=E),w<=R?f.theta=Math.max(w,Math.min(R,f.theta)):f.theta=f.theta>(w+R)/2?Math.max(w,f.theta):Math.min(R,f.theta)),f.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,f.phi)),f.makeSafe(),!0===r.enableDamping?r.target.addScaledVector(g,r.dampingFactor):r.target.add(g),r.target.sub(r.cursor),r.target.clampLength(r.minTargetRadius,r.maxTargetRadius),r.target.add(r.cursor);let S=!1;if(r.zoomToCursor&&C||r.object.isOrthographicCamera)f.radius=clampDistance(f.radius);else{let e=f.radius;f.radius=clampDistance(f.radius*m),S=e!=f.radius}if(t.setFromSpherical(f),t.applyQuaternion(a),v.copy(r.target).add(t),r.object.lookAt(r.target),!0===r.enableDamping?(p.theta*=1-r.dampingFactor,p.phi*=1-r.dampingFactor,g.multiplyScalar(1-r.dampingFactor)):(p.set(0,0,0),g.set(0,0,0)),r.zoomToCursor&&C){let n=null;if(r.object.isPerspectiveCamera){let e=t.length();n=clampDistance(e*m);let s=e-n;r.object.position.addScaledVector(T,s),r.object.updateMatrixWorld(),S=!!s}else if(r.object.isOrthographicCamera){let e=new s.Pa4(P.x,P.y,0);e.unproject(r.object);let i=r.object.zoom;r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/m)),r.object.updateProjectionMatrix(),S=i!==r.object.zoom;let a=new s.Pa4(P.x,P.y,0);a.unproject(r.object),r.object.position.sub(a).add(e),r.object.updateMatrixWorld(),n=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;null!==n&&(this.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(n).add(r.object.position):(o.origin.copy(r.object.position),o.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(o.direction))<c?e.lookAt(r.target):(l.setFromNormalAndCoplanarPoint(r.object.up,r.target),o.intersectPlane(l,r.target))))}else if(r.object.isOrthographicCamera){let e=r.object.zoom;r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/m)),e!==r.object.zoom&&(r.object.updateProjectionMatrix(),S=!0)}return m=1,C=!1,!!(S||A.distanceToSquared(r.object.position)>h||8*(1-b.dot(r.object.quaternion))>h||y.distanceToSquared(r.target)>h)&&(r.dispatchEvent(n),A.copy(r.object.position),b.copy(r.object.quaternion),y.copy(r.target),!0)}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",onContextMenu),r.domElement.removeEventListener("pointerdown",onPointerDown),r.domElement.removeEventListener("pointercancel",onPointerUp),r.domElement.removeEventListener("wheel",onMouseWheel),r.domElement.removeEventListener("pointermove",onPointerMove),r.domElement.removeEventListener("pointerup",onPointerUp);let e=r.domElement.getRootNode();e.removeEventListener("keydown",interceptControlDown,{capture:!0}),null!==r._domElementKeyEvents&&(r._domElementKeyEvents.removeEventListener("keydown",onKeyDown),r._domElementKeyEvents=null)};let r=this,u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},d=u.NONE,h=1e-6,f=new s.$V,p=new s.$V,m=1,g=new s.Pa4,A=new s.FM8,b=new s.FM8,y=new s.FM8,E=new s.FM8,_=new s.FM8,v=new s.FM8,w=new s.FM8,R=new s.FM8,S=new s.FM8,T=new s.Pa4,P=new s.FM8,C=!1,x=[],I={},O=!1;function getZoomScale(e){return Math.pow(.95,r.zoomSpeed*Math.abs(.01*e))}function rotateLeft(e){p.theta-=e}function rotateUp(e){p.phi-=e}let F=function(){let e=new s.Pa4;return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),g.add(e)}}(),M=function(){let e=new s.Pa4;return function(t,s){!0===r.screenSpacePanning?e.setFromMatrixColumn(s,1):(e.setFromMatrixColumn(s,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),g.add(e)}}(),L=function(){let e=new s.Pa4;return function(t,s){let n=r.domElement;if(r.object.isPerspectiveCamera){let i=r.object.position;e.copy(i).sub(r.target);let a=e.length();F(2*t*(a*=Math.tan(r.object.fov/2*Math.PI/180))/n.clientHeight,r.object.matrix),M(2*s*a/n.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(F(t*(r.object.right-r.object.left)/r.object.zoom/n.clientWidth,r.object.matrix),M(s*(r.object.top-r.object.bottom)/r.object.zoom/n.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function dollyOut(e){r.object.isPerspectiveCamera||r.object.isOrthographicCamera?m/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function dollyIn(e){r.object.isPerspectiveCamera||r.object.isOrthographicCamera?m*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function updateZoomParameters(e,t){if(!r.zoomToCursor)return;C=!0;let s=r.domElement.getBoundingClientRect(),n=e-s.left,i=t-s.top,a=s.width,o=s.height;P.x=n/a*2-1,P.y=-(2*(i/o))+1,T.set(P.x,P.y,1).unproject(r.object).sub(r.object.position).normalize()}function clampDistance(e){return Math.max(r.minDistance,Math.min(r.maxDistance,e))}function handleMouseDownRotate(e){A.set(e.clientX,e.clientY)}function handleMouseDownPan(e){E.set(e.clientX,e.clientY)}function handleTouchStartRotate(e){if(1===x.length)A.set(e.pageX,e.pageY);else{let t=getSecondPointerPosition(e),r=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);A.set(r,s)}}function handleTouchStartPan(e){if(1===x.length)E.set(e.pageX,e.pageY);else{let t=getSecondPointerPosition(e),r=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);E.set(r,s)}}function handleTouchStartDolly(e){let t=getSecondPointerPosition(e),r=e.pageX-t.x,s=e.pageY-t.y;w.set(0,Math.sqrt(r*r+s*s))}function handleTouchMoveRotate(e){if(1==x.length)b.set(e.pageX,e.pageY);else{let t=getSecondPointerPosition(e),r=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);b.set(r,s)}y.subVectors(b,A).multiplyScalar(r.rotateSpeed);let t=r.domElement;rotateLeft(2*Math.PI*y.x/t.clientHeight),rotateUp(2*Math.PI*y.y/t.clientHeight),A.copy(b)}function handleTouchMovePan(e){if(1===x.length)_.set(e.pageX,e.pageY);else{let t=getSecondPointerPosition(e),r=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);_.set(r,s)}v.subVectors(_,E).multiplyScalar(r.panSpeed),L(v.x,v.y),E.copy(_)}function handleTouchMoveDolly(e){let t=getSecondPointerPosition(e),s=e.pageX-t.x,n=e.pageY-t.y;R.set(0,Math.sqrt(s*s+n*n)),S.set(0,Math.pow(R.y/w.y,r.zoomSpeed)),dollyOut(S.y),w.copy(R);let i=(e.pageX+t.x)*.5,a=(e.pageY+t.y)*.5;updateZoomParameters(i,a)}function onPointerDown(e){if(!1!==r.enabled)0===x.length&&(r.domElement.setPointerCapture(e.pointerId),r.domElement.addEventListener("pointermove",onPointerMove),r.domElement.addEventListener("pointerup",onPointerUp)),!function(e){for(let t=0;t<x.length;t++)if(x[t]==e.pointerId)return!0;return!1}(e)&&(x.push(e.pointerId),"touch"===e.pointerType?onTouchStart(e):function(e){let t;switch(e.button){case 0:t=r.mouseButtons.LEFT;break;case 1:t=r.mouseButtons.MIDDLE;break;case 2:t=r.mouseButtons.RIGHT;break;default:t=-1}switch(t){case s.RsA.DOLLY:if(!1===r.enableZoom)return;updateZoomParameters(e.clientX,e.clientX),w.set(e.clientX,e.clientY),d=u.DOLLY;break;case s.RsA.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enablePan)return;handleMouseDownPan(e),d=u.PAN}else{if(!1===r.enableRotate)return;handleMouseDownRotate(e),d=u.ROTATE}break;case s.RsA.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enableRotate)return;handleMouseDownRotate(e),d=u.ROTATE}else{if(!1===r.enablePan)return;handleMouseDownPan(e),d=u.PAN}break;default:d=u.NONE}d!==u.NONE&&r.dispatchEvent(i)}(e))}function onPointerMove(e){!1!==r.enabled&&("touch"===e.pointerType?function(e){switch(trackPointer(e),d){case u.TOUCH_ROTATE:if(!1===r.enableRotate)return;handleTouchMoveRotate(e),r.update();break;case u.TOUCH_PAN:if(!1===r.enablePan)return;handleTouchMovePan(e),r.update();break;case u.TOUCH_DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&handleTouchMoveDolly(e),r.enablePan&&handleTouchMovePan(e),r.update();break;case u.TOUCH_DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&handleTouchMoveDolly(e),r.enableRotate&&handleTouchMoveRotate(e),r.update();break;default:d=u.NONE}}(e):function(e){switch(d){case u.ROTATE:if(!1===r.enableRotate)return;!function(e){b.set(e.clientX,e.clientY),y.subVectors(b,A).multiplyScalar(r.rotateSpeed);let t=r.domElement;rotateLeft(2*Math.PI*y.x/t.clientHeight),rotateUp(2*Math.PI*y.y/t.clientHeight),A.copy(b),r.update()}(e);break;case u.DOLLY:if(!1===r.enableZoom)return;R.set(e.clientX,e.clientY),S.subVectors(R,w),S.y>0?dollyOut(getZoomScale(S.y)):S.y<0&&dollyIn(getZoomScale(S.y)),w.copy(R),r.update();break;case u.PAN:if(!1===r.enablePan)return;_.set(e.clientX,e.clientY),v.subVectors(_,E).multiplyScalar(r.panSpeed),L(v.x,v.y),E.copy(_),r.update()}}(e))}function onPointerUp(e){switch(function(e){delete I[e.pointerId];for(let t=0;t<x.length;t++)if(x[t]==e.pointerId){x.splice(t,1);return}}(e),x.length){case 0:r.domElement.releasePointerCapture(e.pointerId),r.domElement.removeEventListener("pointermove",onPointerMove),r.domElement.removeEventListener("pointerup",onPointerUp),r.dispatchEvent(a),d=u.NONE;break;case 1:let t=x[0],s=I[t];onTouchStart({pointerId:t,pageX:s.x,pageY:s.y})}}function onMouseWheel(e){if(!1!==r.enabled&&!1!==r.enableZoom&&d===u.NONE){var t;e.preventDefault(),r.dispatchEvent(i),updateZoomParameters((t=function(e){let t=e.deltaMode,r={clientX:e.clientX,clientY:e.clientY,deltaY:e.deltaY};switch(t){case 1:r.deltaY*=16;break;case 2:r.deltaY*=100}return e.ctrlKey&&!O&&(r.deltaY*=10),r}(e)).clientX,t.clientY),t.deltaY<0?dollyIn(getZoomScale(t.deltaY)):t.deltaY>0&&dollyOut(getZoomScale(t.deltaY)),r.update(),r.dispatchEvent(a)}}function interceptControlDown(e){if("Control"===e.key){O=!0;let e=r.domElement.getRootNode();e.addEventListener("keyup",interceptControlUp,{passive:!0,capture:!0})}}function interceptControlUp(e){if("Control"===e.key){O=!1;let e=r.domElement.getRootNode();e.removeEventListener("keyup",interceptControlUp,{passive:!0,capture:!0})}}function onKeyDown(e){!1!==r.enabled&&!1!==r.enablePan&&function(e){let t=!1;switch(e.code){case r.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?rotateUp(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):L(0,r.keyPanSpeed),t=!0;break;case r.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?rotateUp(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):L(0,-r.keyPanSpeed),t=!0;break;case r.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?rotateLeft(2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):L(r.keyPanSpeed,0),t=!0;break;case r.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?rotateLeft(-2*Math.PI*r.rotateSpeed/r.domElement.clientHeight):L(-r.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),r.update())}(e)}function onTouchStart(e){switch(trackPointer(e),x.length){case 1:switch(r.touches.ONE){case s.QmN.ROTATE:if(!1===r.enableRotate)return;handleTouchStartRotate(e),d=u.TOUCH_ROTATE;break;case s.QmN.PAN:if(!1===r.enablePan)return;handleTouchStartPan(e),d=u.TOUCH_PAN;break;default:d=u.NONE}break;case 2:switch(r.touches.TWO){case s.QmN.DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&handleTouchStartDolly(e),r.enablePan&&handleTouchStartPan(e),d=u.TOUCH_DOLLY_PAN;break;case s.QmN.DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&handleTouchStartDolly(e),r.enableRotate&&handleTouchStartRotate(e),d=u.TOUCH_DOLLY_ROTATE;break;default:d=u.NONE}break;default:d=u.NONE}d!==u.NONE&&r.dispatchEvent(i)}function onContextMenu(e){!1!==r.enabled&&e.preventDefault()}function trackPointer(e){let t=I[e.pointerId];void 0===t&&(t=new s.FM8,I[e.pointerId]=t),t.set(e.pageX,e.pageY)}function getSecondPointerPosition(e){let t=e.pointerId===x[0]?x[1]:x[0];return I[t]}r.domElement.addEventListener("contextmenu",onContextMenu),r.domElement.addEventListener("pointerdown",onPointerDown),r.domElement.addEventListener("pointercancel",onPointerUp),r.domElement.addEventListener("wheel",onMouseWheel,{passive:!1});let N=r.domElement.getRootNode();N.addEventListener("keydown",interceptControlDown,{passive:!0,capture:!0}),this.update()}}},7836:function(e,t,r){"use strict";r.d(t,{E:function(){return GLTFLoader}});var s=r(9477);function toTrianglesDrawMode(e,t){if(t===s.WwZ)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t!==s.z$h&&t!==s.UlW)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e;{let r=e.getIndex();if(null===r){let t=[],s=e.getAttribute("position");if(void 0===s)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<s.count;e++)t.push(e);e.setIndex(t),r=e.getIndex()}let n=r.count-2,i=[];if(t===s.z$h)for(let e=1;e<=n;e++)i.push(r.getX(0)),i.push(r.getX(e)),i.push(r.getX(e+1));else for(let e=0;e<n;e++)e%2==0?(i.push(r.getX(e)),i.push(r.getX(e+1)),i.push(r.getX(e+2))):(i.push(r.getX(e+2)),i.push(r.getX(e+1)),i.push(r.getX(e)));i.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let a=e.clone();return a.setIndex(i),a.clearGroups(),a}}let GLTFLoader=class GLTFLoader extends s.aNw{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new GLTFMaterialsClearcoatExtension(e)}),this.register(function(e){return new GLTFMaterialsDispersionExtension(e)}),this.register(function(e){return new GLTFTextureBasisUExtension(e)}),this.register(function(e){return new GLTFTextureWebPExtension(e)}),this.register(function(e){return new GLTFTextureAVIFExtension(e)}),this.register(function(e){return new GLTFMaterialsSheenExtension(e)}),this.register(function(e){return new GLTFMaterialsTransmissionExtension(e)}),this.register(function(e){return new GLTFMaterialsVolumeExtension(e)}),this.register(function(e){return new GLTFMaterialsIorExtension(e)}),this.register(function(e){return new GLTFMaterialsEmissiveStrengthExtension(e)}),this.register(function(e){return new GLTFMaterialsSpecularExtension(e)}),this.register(function(e){return new GLTFMaterialsIridescenceExtension(e)}),this.register(function(e){return new GLTFMaterialsAnisotropyExtension(e)}),this.register(function(e){return new GLTFMaterialsBumpExtension(e)}),this.register(function(e){return new GLTFLightsExtension(e)}),this.register(function(e){return new GLTFMeshoptCompression(e)}),this.register(function(e){return new GLTFMeshGpuInstancing(e)})}load(e,t,r,n){let i;let a=this;if(""!==this.resourcePath)i=this.resourcePath;else if(""!==this.path){let t=s.Zp0.extractUrlBase(e);i=s.Zp0.resolveURL(t,this.path)}else i=s.Zp0.extractUrlBase(e);this.manager.itemStart(e);let _onError=function(t){n?n(t):console.error(t),a.manager.itemError(e),a.manager.itemEnd(e)},o=new s.hH6(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(r){try{a.parse(r,i,function(r){t(r),a.manager.itemEnd(e)},_onError)}catch(e){_onError(e)}},r,_onError)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return -1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return -1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,s){let a;let o={},l={},c=new TextDecoder;if("string"==typeof e)a=JSON.parse(e);else if(e instanceof ArrayBuffer){let t=c.decode(new Uint8Array(e,0,4));if(t===i){try{o[n.KHR_BINARY_GLTF]=new GLTFBinaryExtension(e)}catch(e){s&&s(e);return}a=JSON.parse(o[n.KHR_BINARY_GLTF].content)}else a=JSON.parse(c.decode(e))}else a=e;if(void 0===a.asset||a.asset.version[0]<2){s&&s(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let u=new GLTFParser(a,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){let t=this.pluginCallbacks[e](u);t.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),l[t.name]=t,o[t.name]=!0}if(a.extensionsUsed)for(let e=0;e<a.extensionsUsed.length;++e){let t=a.extensionsUsed[e],r=a.extensionsRequired||[];switch(t){case n.KHR_MATERIALS_UNLIT:o[t]=new GLTFMaterialsUnlitExtension;break;case n.KHR_DRACO_MESH_COMPRESSION:o[t]=new GLTFDracoMeshCompressionExtension(a,this.dracoLoader);break;case n.KHR_TEXTURE_TRANSFORM:o[t]=new GLTFTextureTransformExtension;break;case n.KHR_MESH_QUANTIZATION:o[t]=new GLTFMeshQuantizationExtension;break;default:r.indexOf(t)>=0&&void 0===l[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}u.setExtensions(o),u.setPlugins(l),u.parse(r,s)}parseAsync(e,t){let r=this;return new Promise(function(s,n){r.parse(e,t,s,n)})}};function GLTFRegistry(){let e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}let n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};let GLTFLightsExtension=class GLTFLightsExtension{constructor(e){this.parser=e,this.name=n.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,t=this.parser.json.nodes||[];for(let r=0,s=t.length;r<s;r++){let s=t[r];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){let t;let r=this.parser,n="light:"+e,i=r.cache.get(n);if(i)return i;let a=r.json,o=a.extensions&&a.extensions[this.name]||{},l=o.lights||[],c=l[e],u=new s.Ilk(16777215);void 0!==c.color&&u.setRGB(c.color[0],c.color[1],c.color[2],s.GUF);let d=void 0!==c.range?c.range:0;switch(c.type){case"directional":(t=new s.Ox3(u)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new s.cek(u)).distance=d;break;case"spot":(t=new s.PMe(u)).distance=d,c.spot=c.spot||{},c.spot.innerConeAngle=void 0!==c.spot.innerConeAngle?c.spot.innerConeAngle:0,c.spot.outerConeAngle=void 0!==c.spot.outerConeAngle?c.spot.outerConeAngle:Math.PI/4,t.angle=c.spot.outerConeAngle,t.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return t.position.set(0,0,0),t.decay=2,assignExtrasToUserData(t,c),void 0!==c.intensity&&(t.intensity=c.intensity),t.name=r.createUniqueName(c.name||"light_"+e),i=Promise.resolve(t),r.cache.add(n,i),i}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){let t=this,r=this.parser,s=r.json,n=s.nodes[e],i=n.extensions&&n.extensions[this.name]||{},a=i.light;return void 0===a?null:this._loadLight(a).then(function(e){return r._getNodeRef(t.cache,a,e)})}};let GLTFMaterialsUnlitExtension=class GLTFMaterialsUnlitExtension{constructor(){this.name=n.KHR_MATERIALS_UNLIT}getMaterialType(){return s.vBJ}extendParams(e,t,r){let n=[];e.color=new s.Ilk(1,1,1),e.opacity=1;let i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){let t=i.baseColorFactor;e.color.setRGB(t[0],t[1],t[2],s.GUF),e.opacity=t[3]}void 0!==i.baseColorTexture&&n.push(r.assignTexture(e,"map",i.baseColorTexture,s.KI_))}return Promise.all(n)}};let GLTFMaterialsEmissiveStrengthExtension=class GLTFMaterialsEmissiveStrengthExtension{constructor(e){this.parser=e,this.name=n.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let n=s.extensions[this.name].emissiveStrength;return void 0!==n&&(t.emissiveIntensity=n),Promise.resolve()}};let GLTFMaterialsClearcoatExtension=class GLTFMaterialsClearcoatExtension{constructor(e){this.parser=e,this.name=n.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let t=this.parser,r=t.json.materials[e];return r.extensions&&r.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],a=n.extensions[this.name];if(void 0!==a.clearcoatFactor&&(t.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&i.push(r.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&i.push(r.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(i.push(r.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){let e=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new s.FM8(e,e)}return Promise.all(i)}};let GLTFMaterialsDispersionExtension=class GLTFMaterialsDispersionExtension{constructor(e){this.parser=e,this.name=n.KHR_MATERIALS_DISPERSION}getMaterialType(e){let t=this.parser,r=t.json.materials[e];return r.extensions&&r.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let n=s.extensions[this.name];return t.dispersion=void 0!==n.dispersion?n.dispersion:0,Promise.resolve()}};let GLTFMaterialsIridescenceExtension=class GLTFMaterialsIridescenceExtension{constructor(e){this.parser=e,this.name=n.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){let t=this.parser,r=t.json.materials[e];return r.extensions&&r.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let n=[],i=s.extensions[this.name];return void 0!==i.iridescenceFactor&&(t.iridescence=i.iridescenceFactor),void 0!==i.iridescenceTexture&&n.push(r.assignTexture(t,"iridescenceMap",i.iridescenceTexture)),void 0!==i.iridescenceIor&&(t.iridescenceIOR=i.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==i.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=i.iridescenceThicknessMinimum),void 0!==i.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=i.iridescenceThicknessMaximum),void 0!==i.iridescenceThicknessTexture&&n.push(r.assignTexture(t,"iridescenceThicknessMap",i.iridescenceThicknessTexture)),Promise.all(n)}};let GLTFMaterialsSheenExtension=class GLTFMaterialsSheenExtension{constructor(e){this.parser=e,this.name=n.KHR_MATERIALS_SHEEN}getMaterialType(e){let t=this.parser,r=t.json.materials[e];return r.extensions&&r.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[];t.sheenColor=new s.Ilk(0,0,0),t.sheenRoughness=0,t.sheen=1;let a=n.extensions[this.name];if(void 0!==a.sheenColorFactor){let e=a.sheenColorFactor;t.sheenColor.setRGB(e[0],e[1],e[2],s.GUF)}return void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&i.push(r.assignTexture(t,"sheenColorMap",a.sheenColorTexture,s.KI_)),void 0!==a.sheenRoughnessTexture&&i.push(r.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(i)}};let GLTFMaterialsTransmissionExtension=class GLTFMaterialsTransmissionExtension{constructor(e){this.parser=e,this.name=n.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let t=this.parser,r=t.json.materials[e];return r.extensions&&r.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let n=[],i=s.extensions[this.name];return void 0!==i.transmissionFactor&&(t.transmission=i.transmissionFactor),void 0!==i.transmissionTexture&&n.push(r.assignTexture(t,"transmissionMap",i.transmissionTexture)),Promise.all(n)}};let GLTFMaterialsVolumeExtension=class GLTFMaterialsVolumeExtension{constructor(e){this.parser=e,this.name=n.KHR_MATERIALS_VOLUME}getMaterialType(e){let t=this.parser,r=t.json.materials[e];return r.extensions&&r.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],a=n.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&i.push(r.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;let o=a.attenuationColor||[1,1,1];return t.attenuationColor=new s.Ilk().setRGB(o[0],o[1],o[2],s.GUF),Promise.all(i)}};let GLTFMaterialsIorExtension=class GLTFMaterialsIorExtension{constructor(e){this.parser=e,this.name=n.KHR_MATERIALS_IOR}getMaterialType(e){let t=this.parser,r=t.json.materials[e];return r.extensions&&r.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let n=s.extensions[this.name];return t.ior=void 0!==n.ior?n.ior:1.5,Promise.resolve()}};let GLTFMaterialsSpecularExtension=class GLTFMaterialsSpecularExtension{constructor(e){this.parser=e,this.name=n.KHR_MATERIALS_SPECULAR}getMaterialType(e){let t=this.parser,r=t.json.materials[e];return r.extensions&&r.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let i=[],a=n.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&i.push(r.assignTexture(t,"specularIntensityMap",a.specularTexture));let o=a.specularColorFactor||[1,1,1];return t.specularColor=new s.Ilk().setRGB(o[0],o[1],o[2],s.GUF),void 0!==a.specularColorTexture&&i.push(r.assignTexture(t,"specularColorMap",a.specularColorTexture,s.KI_)),Promise.all(i)}};let GLTFMaterialsBumpExtension=class GLTFMaterialsBumpExtension{constructor(e){this.parser=e,this.name=n.EXT_MATERIALS_BUMP}getMaterialType(e){let t=this.parser,r=t.json.materials[e];return r.extensions&&r.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let n=[],i=s.extensions[this.name];return t.bumpScale=void 0!==i.bumpFactor?i.bumpFactor:1,void 0!==i.bumpTexture&&n.push(r.assignTexture(t,"bumpMap",i.bumpTexture)),Promise.all(n)}};let GLTFMaterialsAnisotropyExtension=class GLTFMaterialsAnisotropyExtension{constructor(e){this.parser=e,this.name=n.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){let t=this.parser,r=t.json.materials[e];return r.extensions&&r.extensions[this.name]?s.EJi:null}extendMaterialParams(e,t){let r=this.parser,s=r.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();let n=[],i=s.extensions[this.name];return void 0!==i.anisotropyStrength&&(t.anisotropy=i.anisotropyStrength),void 0!==i.anisotropyRotation&&(t.anisotropyRotation=i.anisotropyRotation),void 0!==i.anisotropyTexture&&n.push(r.assignTexture(t,"anisotropyMap",i.anisotropyTexture)),Promise.all(n)}};let GLTFTextureBasisUExtension=class GLTFTextureBasisUExtension{constructor(e){this.parser=e,this.name=n.KHR_TEXTURE_BASISU}loadTexture(e){let t=this.parser,r=t.json,s=r.textures[e];if(!s.extensions||!s.extensions[this.name])return null;let n=s.extensions[this.name],i=t.options.ktx2Loader;if(!i){if(!(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures")}return t.loadTextureImage(e,n.source,i)}};let GLTFTextureWebPExtension=class GLTFTextureWebPExtension{constructor(e){this.parser=e,this.name=n.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){let t=this.name,r=this.parser,s=r.json,n=s.textures[e];if(!n.extensions||!n.extensions[t])return null;let i=n.extensions[t],a=s.images[i.source],o=r.textureLoader;if(a.uri){let e=r.options.manager.getHandler(a.uri);null!==e&&(o=e)}return this.detectSupport().then(function(n){if(n)return r.loadTextureImage(e,i.source,o);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}};let GLTFTextureAVIFExtension=class GLTFTextureAVIFExtension{constructor(e){this.parser=e,this.name=n.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){let t=this.name,r=this.parser,s=r.json,n=s.textures[e];if(!n.extensions||!n.extensions[t])return null;let i=n.extensions[t],a=s.images[i.source],o=r.textureLoader;if(a.uri){let e=r.options.manager.getHandler(a.uri);null!==e&&(o=e)}return this.detectSupport().then(function(n){if(n)return r.loadTextureImage(e,i.source,o);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let t=new Image;t.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",t.onload=t.onerror=function(){e(1===t.height)}})),this.isSupported}};let GLTFMeshoptCompression=class GLTFMeshoptCompression{constructor(e){this.name=n.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let t=this.parser.json,r=t.bufferViews[e];if(!r.extensions||!r.extensions[this.name])return null;{let e=r.extensions[this.name],s=this.parser.getDependency("buffer",e.buffer),n=this.parser.options.meshoptDecoder;if(!n||!n.supported){if(!(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0))return null;throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files")}return s.then(function(t){let r=e.byteOffset||0,s=e.byteLength||0,i=e.count,a=e.byteStride,o=new Uint8Array(t,r,s);return n.decodeGltfBufferAsync?n.decodeGltfBufferAsync(i,a,o,e.mode,e.filter).then(function(e){return e.buffer}):n.ready.then(function(){let t=new ArrayBuffer(i*a);return n.decodeGltfBuffer(new Uint8Array(t),i,a,o,e.mode,e.filter),t})})}}};let GLTFMeshGpuInstancing=class GLTFMeshGpuInstancing{constructor(e){this.name=n.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){let t=this.parser.json,r=t.nodes[e];if(!r.extensions||!r.extensions[this.name]||void 0===r.mesh)return null;let n=t.meshes[r.mesh];for(let e of n.primitives)if(e.mode!==l.TRIANGLES&&e.mode!==l.TRIANGLE_STRIP&&e.mode!==l.TRIANGLE_FAN&&void 0!==e.mode)return null;let i=r.extensions[this.name],a=i.attributes,o=[],c={};for(let e in a)o.push(this.parser.getDependency("accessor",a[e]).then(t=>(c[e]=t,c[e])));return o.length<1?null:(o.push(this.parser.createNodeMesh(e)),Promise.all(o).then(e=>{let t=e.pop(),r=t.isGroup?t.children:[t],n=e[0].count,i=[];for(let e of r){let t=new s.yGw,r=new s.Pa4,a=new s._fP,o=new s.Pa4(1,1,1),l=new s.SPe(e.geometry,e.material,n);for(let e=0;e<n;e++)c.TRANSLATION&&r.fromBufferAttribute(c.TRANSLATION,e),c.ROTATION&&a.fromBufferAttribute(c.ROTATION,e),c.SCALE&&o.fromBufferAttribute(c.SCALE,e),l.setMatrixAt(e,t.compose(r,a,o));for(let t in c)if("_COLOR_0"===t){let e=c[t];l.instanceColor=new s.lb7(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==t&&"ROTATION"!==t&&"SCALE"!==t&&e.geometry.setAttribute(t,c[t]);s.Tme.prototype.copy.call(l,e),this.parser.assignFinalMaterial(l),i.push(l)}return t.isGroup?(t.clear(),t.add(...i),t):i[0]}))}};let i="glTF",a={JSON:1313821514,BIN:5130562};let GLTFBinaryExtension=class GLTFBinaryExtension{constructor(e){this.name=n.KHR_BINARY_GLTF,this.content=null,this.body=null;let t=new DataView(e,0,12),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==i)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw Error("THREE.GLTFLoader: Legacy binary file detected.");let s=this.header.length-12,o=new DataView(e,12),l=0;for(;l<s;){let t=o.getUint32(l,!0);l+=4;let s=o.getUint32(l,!0);if(l+=4,s===a.JSON){let s=new Uint8Array(e,12+l,t);this.content=r.decode(s)}else if(s===a.BIN){let r=12+l;this.body=e.slice(r,r+t)}l+=t}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.")}};let GLTFDracoMeshCompressionExtension=class GLTFDracoMeshCompressionExtension{constructor(e,t){if(!t)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=n.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){let r=this.json,n=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},l={},u={};for(let e in a){let t=f[e]||e.toLowerCase();o[t]=a[e]}for(let t in e.attributes){let s=f[t]||t.toLowerCase();if(void 0!==a[t]){let n=r.accessors[e.attributes[t]],i=c[n.componentType];u[s]=i.name,l[s]=!0===n.normalized}}return t.getDependency("bufferView",i).then(function(e){return new Promise(function(t,r){n.decodeDracoFile(e,function(e){for(let t in e.attributes){let r=e.attributes[t],s=l[t];void 0!==s&&(r.normalized=s)}t(e)},o,u,s.GUF,r)})})}};let GLTFTextureTransformExtension=class GLTFTextureTransformExtension{constructor(){this.name=n.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return(void 0===t.texCoord||t.texCoord===e.channel)&&void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.texCoord&&(e.channel=t.texCoord),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}};let GLTFMeshQuantizationExtension=class GLTFMeshQuantizationExtension{constructor(){this.name=n.KHR_MESH_QUANTIZATION}};let GLTFCubicSplineInterpolant=class GLTFCubicSplineInterpolant extends s._C8{constructor(e,t,r,s){super(e,t,r,s)}copySampleValue_(e){let t=this.resultBuffer,r=this.sampleValues,s=this.valueSize,n=e*s*3+s;for(let e=0;e!==s;e++)t[e]=r[n+e];return t}interpolate_(e,t,r,s){let n=this.resultBuffer,i=this.sampleValues,a=this.valueSize,o=2*a,l=3*a,c=s-t,u=(r-t)/c,d=u*u,h=d*u,f=e*l,p=f-l,m=-2*h+3*d,g=h-d,A=1-m,b=g-d+u;for(let e=0;e!==a;e++){let t=i[p+e+a],r=i[p+e+o]*c,s=i[f+e+a],l=i[f+e]*c;n[e]=A*t+b*r+m*s+g*l}return n}};let o=new s._fP;let GLTFCubicSplineQuaternionInterpolant=class GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant{interpolate_(e,t,r,s){let n=super.interpolate_(e,t,r,s);return o.fromArray(n).normalize().toArray(n),n}};let l={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},c={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},u={9728:s.TyD,9729:s.wem,9984:s.YLQ,9985:s.qyh,9986:s.aH4,9987:s.D1R},d={33071:s.uWy,33648:s.OoA,10497:s.rpg},h={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},f={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},p={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},m={CUBICSPLINE:void 0,LINEAR:s.NMF,STEP:s.Syv},g={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function addUnknownExtensionsToUserData(e,t,r){for(let s in r.extensions)void 0===e[s]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[s]=r.extensions[s])}function assignExtrasToUserData(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function createAttributesKey(e){let t="",r=Object.keys(e).sort();for(let s=0,n=r.length;s<n;s++)t+=r[s]+":"+e[r[s]]+";";return t}function getNormalizedComponentScale(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}let A=new s.yGw;let GLTFParser=class GLTFParser{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new GLTFRegistry,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,n=!1,i=-1;"undefined"!=typeof navigator&&(r=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),i=(n=navigator.userAgent.indexOf("Firefox")>-1)?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"==typeof createImageBitmap||r||n&&i<98?this.textureLoader=new s.dpR(this.options.manager):this.textureLoader=new s.QRU(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new s.hH6(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){let r=this,s=this.json,n=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(t){let i={scene:t[0][s.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:s.asset,parser:r,userData:{}};return addUnknownExtensionsToUserData(n,i,s),assignExtrasToUserData(i,s),Promise.all(r._invokeAll(function(e){return e.afterRoot&&e.afterRoot(i)})).then(function(){for(let e of i.scenes)e.updateMatrixWorld();e(i)})}).catch(t)}_markDefs(){let e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[];for(let r=0,s=t.length;r<s;r++){let s=t[r].joints;for(let t=0,r=s.length;t<r;t++)e[s[t]].isBone=!0}for(let t=0,s=e.length;t<s;t++){let s=e[t];void 0!==s.mesh&&(this._addNodeRef(this.meshCache,s.mesh),void 0!==s.skin&&(r[s.mesh].isSkinnedMesh=!0)),void 0!==s.camera&&this._addNodeRef(this.cameraCache,s.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,r){if(e.refs[t]<=1)return r;let s=r.clone(),updateMappings=(e,t)=>{let r=this.associations.get(e);for(let[s,n]of(null!=r&&this.associations.set(t,r),e.children.entries()))updateMappings(n,t.children[s])};return updateMappings(r,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){let t=Object.values(this.plugins);t.push(this);for(let r=0;r<t.length;r++){let s=e(t[r]);if(s)return s}return null}_invokeAll(e){let t=Object.values(this.plugins);t.unshift(this);let r=[];for(let s=0;s<t.length;s++){let n=e(t[s]);n&&r.push(n)}return r}getDependency(e,t){let r=e+":"+t,s=this.cache.get(r);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this._invokeOne(function(e){return e.loadNode&&e.loadNode(t)});break;case"mesh":s=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(t)});break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(t)});break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(t)});break;case"texture":s=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(t)});break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(t)});break;case"camera":s=this.loadCamera(t);break;default:if(!(s=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,t)})))throw Error("Unknown type: "+e)}this.cache.add(r,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){let r=this,s=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(s.map(function(t,s){return r.getDependency(e,s)})),this.cache.add(e,t)}return t}loadBuffer(e){let t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[n.KHR_BINARY_GLTF].body);let i=this.options;return new Promise(function(e,n){r.load(s.Zp0.resolveURL(t.uri,i.path),e,void 0,function(){n(Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){let t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){let r=t.byteLength||0,s=t.byteOffset||0;return e.slice(s,s+r)})}loadAccessor(e){let t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse){let e=h[n.type],t=c[n.componentType],r=!0===n.normalized,i=new t(n.count*e);return Promise.resolve(new s.TlE(i,e,r))}let i=[];return void 0!==n.bufferView?i.push(this.getDependency("bufferView",n.bufferView)):i.push(null),void 0!==n.sparse&&(i.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(i).then(function(e){let i,a;let o=e[0],l=h[n.type],u=c[n.componentType],d=u.BYTES_PER_ELEMENT,f=d*l,p=n.byteOffset||0,m=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,g=!0===n.normalized;if(m&&m!==f){let e=Math.floor(p/m),r="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+e+":"+n.count,c=t.cache.get(r);c||(i=new u(o,e*m,n.count*m/d),c=new s.vpT(i,m/d),t.cache.add(r,c)),a=new s.kB5(c,l,p%m/d,g)}else i=null===o?new u(n.count*l):new u(o,p,n.count*l),a=new s.TlE(i,l,g);if(void 0!==n.sparse){let t=h.SCALAR,r=c[n.sparse.indices.componentType],i=n.sparse.indices.byteOffset||0,d=n.sparse.values.byteOffset||0,f=new r(e[1],i,n.sparse.count*t),p=new u(e[2],d,n.sparse.count*l);null!==o&&(a=new s.TlE(a.array.slice(),a.itemSize,a.normalized));for(let e=0,t=f.length;e<t;e++){let t=f[e];if(a.setX(t,p[e*l]),l>=2&&a.setY(t,p[e*l+1]),l>=3&&a.setZ(t,p[e*l+2]),l>=4&&a.setW(t,p[e*l+3]),l>=5)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return a})}loadTexture(e){let t=this.json,r=this.options,s=t.textures[e],n=s.source,i=t.images[n],a=this.textureLoader;if(i.uri){let e=r.manager.getHandler(i.uri);null!==e&&(a=e)}return this.loadTextureImage(e,n,a)}loadTextureImage(e,t,r){let n=this,i=this.json,a=i.textures[e],o=i.images[t],l=(o.uri||o.bufferView)+":"+a.sampler;if(this.textureCache[l])return this.textureCache[l];let c=this.loadImageSource(t,r).then(function(t){t.flipY=!1,t.name=a.name||o.name||"",""===t.name&&"string"==typeof o.uri&&!1===o.uri.startsWith("data:image/")&&(t.name=o.uri);let r=i.samplers||{},l=r[a.sampler]||{};return t.magFilter=u[l.magFilter]||s.wem,t.minFilter=u[l.minFilter]||s.D1R,t.wrapS=d[l.wrapS]||s.rpg,t.wrapT=d[l.wrapT]||s.rpg,n.associations.set(t,{textures:e}),t}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,t){let r=this.json,n=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(e=>e.clone());let i=r.images[e],a=self.URL||self.webkitURL,o=i.uri||"",l=!1;if(void 0!==i.bufferView)o=this.getDependency("bufferView",i.bufferView).then(function(e){l=!0;let t=new Blob([e],{type:i.mimeType});return o=a.createObjectURL(t)});else if(void 0===i.uri)throw Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let c=Promise.resolve(o).then(function(e){return new Promise(function(r,i){let a=r;!0===t.isImageBitmapLoader&&(a=function(e){let t=new s.xEZ(e);t.needsUpdate=!0,r(t)}),t.load(s.Zp0.resolveURL(e,n.path),a,void 0,i)})}).then(function(e){var t;return!0===l&&a.revokeObjectURL(o),e.userData.mimeType=i.mimeType||((t=i.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e}).catch(function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),e});return this.sourceCache[e]=c,c}assignTexture(e,t,r,s){let i=this;return this.getDependency("texture",r.index).then(function(a){if(!a)return null;if(void 0!==r.texCoord&&r.texCoord>0&&((a=a.clone()).channel=r.texCoord),i.extensions[n.KHR_TEXTURE_TRANSFORM]){let e=void 0!==r.extensions?r.extensions[n.KHR_TEXTURE_TRANSFORM]:void 0;if(e){let t=i.associations.get(a);a=i.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(a,e),i.associations.set(a,t)}}return void 0!==s&&(a.colorSpace=s),e[t]=a,a})}assignFinalMaterial(e){let t=e.geometry,r=e.material,n=void 0===t.attributes.tangent,i=void 0!==t.attributes.color,a=void 0===t.attributes.normal;if(e.isPoints){let e="PointsMaterial:"+r.uuid,t=this.cache.get(e);t||(t=new s.UY4,s.F5T.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,t.sizeAttenuation=!1,this.cache.add(e,t)),r=t}else if(e.isLine){let e="LineBasicMaterial:"+r.uuid,t=this.cache.get(e);t||(t=new s.nls,s.F5T.prototype.copy.call(t,r),t.color.copy(r.color),t.map=r.map,this.cache.add(e,t)),r=t}if(n||i||a){let e="ClonedMaterial:"+r.uuid+":";n&&(e+="derivative-tangents:"),i&&(e+="vertex-colors:"),a&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=r.clone(),i&&(t.vertexColors=!0),a&&(t.flatShading=!0),n&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(r))),r=t}e.material=r}getMaterialType(){return s.Wid}loadMaterial(e){let t;let r=this,i=this.json,a=this.extensions,o=i.materials[e],l={},c=o.extensions||{},u=[];if(c[n.KHR_MATERIALS_UNLIT]){let e=a[n.KHR_MATERIALS_UNLIT];t=e.getMaterialType(),u.push(e.extendParams(l,o,r))}else{let n=o.pbrMetallicRoughness||{};if(l.color=new s.Ilk(1,1,1),l.opacity=1,Array.isArray(n.baseColorFactor)){let e=n.baseColorFactor;l.color.setRGB(e[0],e[1],e[2],s.GUF),l.opacity=e[3]}void 0!==n.baseColorTexture&&u.push(r.assignTexture(l,"map",n.baseColorTexture,s.KI_)),l.metalness=void 0!==n.metallicFactor?n.metallicFactor:1,l.roughness=void 0!==n.roughnessFactor?n.roughnessFactor:1,void 0!==n.metallicRoughnessTexture&&(u.push(r.assignTexture(l,"metalnessMap",n.metallicRoughnessTexture)),u.push(r.assignTexture(l,"roughnessMap",n.metallicRoughnessTexture))),t=this._invokeOne(function(t){return t.getMaterialType&&t.getMaterialType(e)}),u.push(Promise.all(this._invokeAll(function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,l)})))}!0===o.doubleSided&&(l.side=s.ehD);let d=o.alphaMode||g.OPAQUE;if(d===g.BLEND?(l.transparent=!0,l.depthWrite=!1):(l.transparent=!1,d===g.MASK&&(l.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&t!==s.vBJ&&(u.push(r.assignTexture(l,"normalMap",o.normalTexture)),l.normalScale=new s.FM8(1,1),void 0!==o.normalTexture.scale)){let e=o.normalTexture.scale;l.normalScale.set(e,e)}if(void 0!==o.occlusionTexture&&t!==s.vBJ&&(u.push(r.assignTexture(l,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(l.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&t!==s.vBJ){let e=o.emissiveFactor;l.emissive=new s.Ilk().setRGB(e[0],e[1],e[2],s.GUF)}return void 0!==o.emissiveTexture&&t!==s.vBJ&&u.push(r.assignTexture(l,"emissiveMap",o.emissiveTexture,s.KI_)),Promise.all(u).then(function(){let s=new t(l);return o.name&&(s.name=o.name),assignExtrasToUserData(s,o),r.associations.set(s,{materials:e}),o.extensions&&addUnknownExtensionsToUserData(a,s,o),s})}createUniqueName(e){let t=s.iUV.sanitizeNodeName(e||"");return t in this.nodeNamesUsed?t+"_"+ ++this.nodeNamesUsed[t]:(this.nodeNamesUsed[t]=0,t)}loadGeometries(e){let t=this,r=this.extensions,i=this.primitiveCache,a=[];for(let o=0,l=e.length;o<l;o++){let l=e[o],c=function(e){let t;let r=e.extensions&&e.extensions[n.KHR_DRACO_MESH_COMPRESSION];if(t=r?"draco:"+r.bufferView+":"+r.indices+":"+createAttributesKey(r.attributes):e.indices+":"+createAttributesKey(e.attributes)+":"+e.mode,void 0!==e.targets)for(let r=0,s=e.targets.length;r<s;r++)t+=":"+createAttributesKey(e.targets[r]);return t}(l),u=i[c];if(u)a.push(u.promise);else{let e;e=l.extensions&&l.extensions[n.KHR_DRACO_MESH_COMPRESSION]?function(e){return r[n.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(r){return addPrimitiveAttributes(r,e,t)})}(l):addPrimitiveAttributes(new s.u9r,l,t),i[c]={primitive:l,promise:e},a.push(e)}}return Promise.all(a)}loadMesh(e){let t=this,r=this.json,n=this.extensions,i=r.meshes[e],a=i.primitives,o=[];for(let e=0,t=a.length;e<t;e++){var c;let t=void 0===a[e].material?(void 0===(c=this.cache).DefaultMaterial&&(c.DefaultMaterial=new s.Wid({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:s.Wl3})),c.DefaultMaterial):this.getDependency("material",a[e].material);o.push(t)}return o.push(t.loadGeometries(a)),Promise.all(o).then(function(r){let o=r.slice(0,r.length-1),c=r[r.length-1],u=[];for(let r=0,d=c.length;r<d;r++){let d;let h=c[r],f=a[r],p=o[r];if(f.mode===l.TRIANGLES||f.mode===l.TRIANGLE_STRIP||f.mode===l.TRIANGLE_FAN||void 0===f.mode)!0===(d=!0===i.isSkinnedMesh?new s.TUv(h,p):new s.Kj0(h,p)).isSkinnedMesh&&d.normalizeSkinWeights(),f.mode===l.TRIANGLE_STRIP?d.geometry=toTrianglesDrawMode(d.geometry,s.UlW):f.mode===l.TRIANGLE_FAN&&(d.geometry=toTrianglesDrawMode(d.geometry,s.z$h));else if(f.mode===l.LINES)d=new s.ejS(h,p);else if(f.mode===l.LINE_STRIP)d=new s.x12(h,p);else if(f.mode===l.LINE_LOOP)d=new s.blk(h,p);else if(f.mode===l.POINTS)d=new s.woe(h,p);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+f.mode);Object.keys(d.geometry.morphAttributes).length>0&&function(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let r=0,s=t.weights.length;r<s;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){let r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(let t=0,s=r.length;t<s;t++)e.morphTargetDictionary[r[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}(d,i),d.name=t.createUniqueName(i.name||"mesh_"+e),assignExtrasToUserData(d,i),f.extensions&&addUnknownExtensionsToUserData(n,d,f),t.assignFinalMaterial(d),u.push(d)}for(let r=0,s=u.length;r<s;r++)t.associations.set(u[r],{meshes:e,primitives:r});if(1===u.length)return i.extensions&&addUnknownExtensionsToUserData(n,u[0],i),u[0];let d=new s.ZAu;i.extensions&&addUnknownExtensionsToUserData(n,d,i),t.associations.set(d,{meshes:e});for(let e=0,t=u.length;e<t;e++)d.add(u[e]);return d})}loadCamera(e){let t;let r=this.json.cameras[e],n=r[r.type];if(!n){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return"perspective"===r.type?t=new s.cPb(s.M8C.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new s.iKG(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),r.name&&(t.name=this.createUniqueName(r.name)),assignExtrasToUserData(t,r),Promise.resolve(t)}loadSkin(e){let t=this.json.skins[e],r=[];for(let e=0,s=t.joints.length;e<s;e++)r.push(this._loadNodeShallow(t.joints[e]));return void 0!==t.inverseBindMatrices?r.push(this.getDependency("accessor",t.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(e){let r=e.pop(),n=[],i=[];for(let a=0,o=e.length;a<o;a++){let o=e[a];if(o){n.push(o);let e=new s.yGw;null!==r&&e.fromArray(r.array,16*a),i.push(e)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[a])}return new s.OdW(n,i)})}loadAnimation(e){let t=this.json,r=this,n=t.animations[e],i=n.name?n.name:"animation_"+e,a=[],o=[],l=[],c=[],u=[];for(let e=0,t=n.channels.length;e<t;e++){let t=n.channels[e],r=n.samplers[t.sampler],s=t.target,i=s.node,d=void 0!==n.parameters?n.parameters[r.input]:r.input,h=void 0!==n.parameters?n.parameters[r.output]:r.output;void 0!==s.node&&(a.push(this.getDependency("node",i)),o.push(this.getDependency("accessor",d)),l.push(this.getDependency("accessor",h)),c.push(r),u.push(s))}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(l),Promise.all(c),Promise.all(u)]).then(function(e){let t=e[0],n=e[1],a=e[2],o=e[3],l=e[4],c=[];for(let e=0,s=t.length;e<s;e++){let s=t[e],i=n[e],u=a[e],d=o[e],h=l[e];if(void 0===s)continue;s.updateMatrix&&s.updateMatrix();let f=r._createAnimationTracks(s,i,u,d,h);if(f)for(let e=0;e<f.length;e++)c.push(f[e])}return new s.m7l(i,void 0,c)})}createNodeMesh(e){let t=this.json,r=this,s=t.nodes[e];return void 0===s.mesh?null:r.getDependency("mesh",s.mesh).then(function(e){let t=r._getNodeRef(r.meshCache,s.mesh,e);return void 0!==s.weights&&t.traverse(function(e){if(e.isMesh)for(let t=0,r=s.weights.length;t<r;t++)e.morphTargetInfluences[t]=s.weights[t]}),t})}loadNode(e){let t=this.json,r=t.nodes[e],s=this._loadNodeShallow(e),n=[],i=r.children||[];for(let e=0,t=i.length;e<t;e++)n.push(this.getDependency("node",i[e]));let a=void 0===r.skin?Promise.resolve(null):this.getDependency("skin",r.skin);return Promise.all([s,Promise.all(n),a]).then(function(e){let t=e[0],r=e[1],s=e[2];null!==s&&t.traverse(function(e){e.isSkinnedMesh&&e.bind(s,A)});for(let e=0,s=r.length;e<s;e++)t.add(r[e]);return t})}_loadNodeShallow(e){let t=this.json,r=this.extensions,n=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];let i=t.nodes[e],a=i.name?n.createUniqueName(i.name):"",o=[],l=n._invokeOne(function(t){return t.createNodeMesh&&t.createNodeMesh(e)});return l&&o.push(l),void 0!==i.camera&&o.push(n.getDependency("camera",i.camera).then(function(e){return n._getNodeRef(n.cameraCache,i.camera,e)})),n._invokeAll(function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)}).forEach(function(e){o.push(e)}),this.nodeCache[e]=Promise.all(o).then(function(t){let o;if((o=!0===i.isBone?new s.N$j:t.length>1?new s.ZAu:1===t.length?t[0]:new s.Tme)!==t[0])for(let e=0,r=t.length;e<r;e++)o.add(t[e]);if(i.name&&(o.userData.name=i.name,o.name=a),assignExtrasToUserData(o,i),i.extensions&&addUnknownExtensionsToUserData(r,o,i),void 0!==i.matrix){let e=new s.yGw;e.fromArray(i.matrix),o.applyMatrix4(e)}else void 0!==i.translation&&o.position.fromArray(i.translation),void 0!==i.rotation&&o.quaternion.fromArray(i.rotation),void 0!==i.scale&&o.scale.fromArray(i.scale);return n.associations.has(o)||n.associations.set(o,{}),n.associations.get(o).nodes=e,o}),this.nodeCache[e]}loadScene(e){let t=this.extensions,r=this.json.scenes[e],n=this,i=new s.ZAu;r.name&&(i.name=n.createUniqueName(r.name)),assignExtrasToUserData(i,r),r.extensions&&addUnknownExtensionsToUserData(t,i,r);let a=r.nodes||[],o=[];for(let e=0,t=a.length;e<t;e++)o.push(n.getDependency("node",a[e]));return Promise.all(o).then(function(e){for(let t=0,r=e.length;t<r;t++)i.add(e[t]);return n.associations=(e=>{let t=new Map;for(let[e,r]of n.associations)(e instanceof s.F5T||e instanceof s.xEZ)&&t.set(e,r);return e.traverse(e=>{let r=n.associations.get(e);null!=r&&t.set(e,r)}),t})(i),i})}_createAnimationTracks(e,t,r,n,i){let a;let o=[],l=e.name?e.name:e.uuid,c=[];switch(p[i.path]===p.weights?e.traverse(function(e){e.morphTargetInfluences&&c.push(e.name?e.name:e.uuid)}):c.push(l),p[i.path]){case p.weights:a=s.dUE;break;case p.rotation:a=s.iLg;break;case p.position:case p.scale:a=s.yC1;break;default:a=1===r.itemSize?s.dUE:s.yC1}let u=void 0!==n.interpolation?m[n.interpolation]:s.NMF,d=this._getArrayFromAccessor(r);for(let e=0,r=c.length;e<r;e++){let r=new a(c[e]+"."+p[i.path],t.array,d,u);"CUBICSPLINE"===n.interpolation&&this._createCubicSplineTrackInterpolant(r),o.push(r)}return o}_getArrayFromAccessor(e){let t=e.array;if(e.normalized){let e=getNormalizedComponentScale(t.constructor),r=new Float32Array(t.length);for(let s=0,n=t.length;s<n;s++)r[s]=t[s]*e;t=r}return t}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){let t=this instanceof s.iLg?GLTFCubicSplineQuaternionInterpolant:GLTFCubicSplineInterpolant;return new t(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function addPrimitiveAttributes(e,t,r){let n=t.attributes,i=[];for(let t in n){let s=f[t]||t.toLowerCase();s in e.attributes||i.push(function(t,s){return r.getDependency("accessor",t).then(function(t){e.setAttribute(s,t)})}(n[t],s))}if(void 0!==t.indices&&!e.index){let s=r.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});i.push(s)}return s.epp.workingColorSpace!==s.GUF&&"COLOR_0"in n&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${s.epp.workingColorSpace}" not supported.`),assignExtrasToUserData(e,t),!function(e,t,r){let n=t.attributes,i=new s.ZzF;if(void 0===n.POSITION)return;{let e=r.json.accessors[n.POSITION],t=e.min,a=e.max;if(void 0!==t&&void 0!==a){if(i.set(new s.Pa4(t[0],t[1],t[2]),new s.Pa4(a[0],a[1],a[2])),e.normalized){let t=getNormalizedComponentScale(c[e.componentType]);i.min.multiplyScalar(t),i.max.multiplyScalar(t)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}let a=t.targets;if(void 0!==a){let e=new s.Pa4,t=new s.Pa4;for(let s=0,n=a.length;s<n;s++){let n=a[s];if(void 0!==n.POSITION){let s=r.json.accessors[n.POSITION],i=s.min,a=s.max;if(void 0!==i&&void 0!==a){if(t.setX(Math.max(Math.abs(i[0]),Math.abs(a[0]))),t.setY(Math.max(Math.abs(i[1]),Math.abs(a[1]))),t.setZ(Math.max(Math.abs(i[2]),Math.abs(a[2]))),s.normalized){let e=getNormalizedComponentScale(c[s.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(e)}e.boundingBox=i;let o=new s.aLr;i.getCenter(o.center),o.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=o}(e,t,r),Promise.all(i).then(function(){return void 0!==t.targets?function(e,t,r){let s=!1,n=!1,i=!1;for(let e=0,r=t.length;e<r;e++){let r=t[e];if(void 0!==r.POSITION&&(s=!0),void 0!==r.NORMAL&&(n=!0),void 0!==r.COLOR_0&&(i=!0),s&&n&&i)break}if(!s&&!n&&!i)return Promise.resolve(e);let a=[],o=[],l=[];for(let c=0,u=t.length;c<u;c++){let u=t[c];if(s){let t=void 0!==u.POSITION?r.getDependency("accessor",u.POSITION):e.attributes.position;a.push(t)}if(n){let t=void 0!==u.NORMAL?r.getDependency("accessor",u.NORMAL):e.attributes.normal;o.push(t)}if(i){let t=void 0!==u.COLOR_0?r.getDependency("accessor",u.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(l)]).then(function(t){let r=t[0],a=t[1],o=t[2];return s&&(e.morphAttributes.position=r),n&&(e.morphAttributes.normal=a),i&&(e.morphAttributes.color=o),e.morphTargetsRelative=!0,e})}(e,t.targets,r):e})}}}]);